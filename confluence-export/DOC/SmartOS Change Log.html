<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>SmartOS Documentation : SmartOS Change Log</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            SmartOS Documentation : SmartOS Change Log
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jul 08, 2016 by <font color="#0050B2">brian.bennett@joyent.com</font>.
				    </div>

				    <h3><a name="SmartOSChangeLog-DownloadhereDownloadSmartOS."></a>Download <a href="Download SmartOS.html" title="Download SmartOS">here</a>.</h3>

<h1><a name="SmartOSChangeLog-Changelogshavemoved."></a>Changelogs have moved.</h1>


<h3><a name="SmartOSChangeLog-"></a></h3>


<h3><a name="SmartOSChangeLog-SeetheautogeneratedchangelogsdirectlyinManta%28requiresjavascript%29"></a>See the autogenerated changelogs <a href="http://us-east.manta.joyent.com/Joyent_Dev/public/SmartOS/smartos.html">directly in Manta (requires javascript)</a> and watch for build flag day announcements and other major feature releases on the <a href="Mailing Lists and IRC.html" title="Mailing Lists and IRC">smartos-discuss mailing list</a>.</h3>

<h2><a name="SmartOSChangeLog-September19%2C2013"></a>September 19, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2483 catman generation copies linked pages<br/>
OS-2497 remove use of system.getProvisionableMemory() leaving decisions about space reservation to caller or something else upstack.<br/>
OS-2487: 'imgadm import' rollback shouldn't complain about not being able to delete &#45;partial dataset<br/>
OS-2383 want support for HP/Compaq SmartArray controllers<br/>
OS-2494 need node-libuuid module in the platform<br/>
FWAPI-75: fwadm: list remote VMs<br/>
FWAPI-82: fwadm: want &#45;-owner_uuid option; fwadm now outputs which remote VMs were added or updated.<br/>
OS-2488 incremental imgadm create should bork if no @final snapshot on the origin image<br/>
ZAPI-404 add tests to ensure snapshots working w/ SNGL<br/>
'make check'<br/>
OS-2489: imgadm create must fail on 'zfs send' error<br/>
OS-2491 fix race condition between zfs set {compression,refreservation} and zfs list in VM.js<br/>
OS-2400: occassional 'HashUpdate fail' in 'imgadm create ...'<br/>
OS-2485 configure is missing pkg_alternatives<br/>
OS-2482 add support for sdc:operator-script which will pull from internal_metadataoperator-script</p>

<p>illumos<br/>
&#45;<del>&#45;</del>&#45;-&#45;&#45;</p>

<p>OS-2502 illumos-joyent manifest should be sorted<br/>
4122 do_sysfile_cmd colon-separates the module path, and then we can't parse it<br/>
3789 iscsid disables warnings<br/>
1770 3libucb and 3ucb manpages are 6 years behind reality<br/>
OS-2383 want support for HP/Compaq SmartArray controllers<br/>
1601 date command should support &#43;%N<br/>
4023 Properly escape newlines and carriage returns in man pages<br/>
4078 groupadd execs getent unnecessarily<br/>
4127 dmake setup could create /etc/skel<br/>
3737 grep does not support &#45;H option<br/>
3759 egrep(1) and fgrep(1) &#45;s flag does not hide &#45;c output<br/>
3806 illumos build execs echo unnecessarily<br/>
4020 Make ldi_ev_remove_callbacks safe to use in LDI callbacks<br/>
4099 SMF methods without absolute paths no longer work<br/>
OS-2469 missing fm driver prevents all CPU and memory diagnosis on all HW<br/>
4111 wcwidth() still not right for some characters</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<p>HVM-782 want walkers for various bits of nic state</p>

<h2><a name="SmartOSChangeLog-September09%2C2013"></a>September 09, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2456 sd timeout/retry settings are absurd<br/>
OS-2457 mptsas timeout subsystem needs finer granularity<br/>
3600 edit(1) is a bad .so reference (fix merge cruft)<br/>
OS-2474: If we get an error trying to create the zone socket, back-off and retry a few seconds later.<br/>
OS-2479 the ramdisk must grow to accommodate gdamore's locales<br/>
OS-2465 'imgadm create' should clean up its '@final' snapshot on the dataset on failure<br/>
OS-2466 'imgadm create' should not fail on an existing '@final' snapshot on the VM<br/>
OS-2453 only call callback once when there's an error posting to vmadmd.<br/>
OS-2426 return an error when vmadm is unable to talk to vmadmd.<br/>
FWAPI-72: fw.js: need to determine if remote VMs are the target of rules</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>OS-2437 arc_get_data_buf() blocks in vmem_alloc() instead of evicting<br/>
OS-2432 tail &#45;f/-F missing some truncation events<br/>
OS-2433 tail &#45;f/-F can produce duplicate output after a truncation<br/>
OS-2456 sd timeout/retry settings are absurd<br/>
3600 edit(1) is a bad .so reference (fix merge cruft)<br/>
2408 CJK character width handled incorrectly in terminal emulators (missing widths-2.txt)<br/>
2408 CJK character width handled incorrectly in terminal emulators<br/>
3019 localedef(1) manpage is pretty out of date<br/>
672 xargs doesn't support &#45;0<br/>
3356 xargs needlessly duplicates stdio buffering<br/>
4075 nscd spuriously thinks all databases are privileged<br/>
3965 find does not support &#45;delete option<br/>
3933 contract adoption can race<br/>
1974 pages_pp_maximum/lotsfree discrepancy leads to mlock() failure<br/>
4072 make clobber leaves trash<br/>
3600 edit(1) is a bad .so reference<br/>
4082 zfs receive gets EFBIG from dmu_tx_hold_free()<br/>
3954 metaslabs continue to load even after hitting zfs_mg_alloc_failure limit<br/>
4080 zpool clear fails to clear pool<br/>
4081 need zfs_mg_noalloc_threshold<br/>
4049 filesystem(5) documents /usr/bin/amd64 twice<br/>
4048 cpu_acpi is too verbose about disabled SpeedStep/PowerNow&#33; support<br/>
OS-2463 restore zone-based zfs scheduling, based on new behavior<br/>
OS-2444 richmond hardware maps need to support ivy bridge<br/>
195 Need replacement for nfs/lockd+klm (exception_lists)<br/>
3946 ::gcore (fix sparc build)<br/>
3518 Incorrect hostid calculation<br/>
195 Need replacement for nfs/lockd+klm<br/>
4045 zfs write throttle &amp; i/o scheduler performance work<br/>
3845 beadm doesn't work in non-global zones<br/>
4054 dis sometimes decides random symbols are functions<br/>
3194 dis crashes disassembling aes<br/>
2932 support crash dumps to raidz, etc. pools (fix mismerge)<br/>
OS-2450 libproc assertion failure<br/>
1765 assert triggered in libzfs_import.c trying to import pool name beginning with a number<br/>
2932 support crash dumps to raidz, etc. pools<br/>
3785 Implement MAP_32BIT flag to mmap()<br/>
OS-2417 fix multi-vdev crash dump feature enabling<br/>
4046 dsl_dataset_t ds_dir-&gt;dd_lock is highly contended<br/>
3974 mistake on stdlib.h</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-August08%2C2013"></a>August 08, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>FWAPI-43: No man page for fwadm<br/>
OS-2403 'imgadm create &#45;-publish ...' passes incorrect path to the publish subcmd if compression is used<br/>
OS-2401 imgadm support for incremental images (missing file from manifest)<br/>
OS-2401 imgadm support for incremental images<br/>
OS-1920 src/img/lib/imgadm.js "_installImage" is a beast, refactor<br/>
OS-2397 mkisofs breaks when LANG set to UTF-8 locale</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>3956 ::vdev &#45;r should work with pipelines<br/>
3957 ztest should update the cachefile before killing itself<br/>
3958 multiple scans can lead to partial resilvering<br/>
3959 ddt entries are not always resilvered<br/>
3960 dsl_scan can skip over dedup-ed blocks if physical birth &#33;= logical birth<br/>
3961 freed gang blocks are not resilvered and can cause pool to suspend<br/>
3962 ztest should print out zfs debug buffer before exiting<br/>
3955 ztest failure: assertion refcount_count(&amp;tx-&gt;tx_space_written) + delta &lt;= tx-&gt;tx_space_towrite<br/>
3949 ztest fault injection should avoid resilvering devices<br/>
3950 ztest: deadman fires when we're doing a scan<br/>
3951 ztest hang when running dedup test<br/>
3952 ztest: ztest_reguid test and ztest_fault_inject don't place nice together<br/>
backout 6910752/6968206: needs more work<br/>
3992 mdb ::stacks segv<br/>
3966 zfs lz4 compression (etc) should have bumped grub capability VERSION<br/>
3925 IP DCE does not scale (fix sparc)<br/>
3973 zfs_ioc_rename alters passed in zc-&gt;zc_name<br/>
3925 IP DCE does not scale<br/>
3972 ps - missing column separator<br/>
3988 kstat(1) woefully inefficient on fully specified kstats<br/>
3916 elfcore() can induce panic in bcopy()<br/>
3923 Users should be able to lower nice value of processes within a zone<br/>
3924 privileges.5 man page missing PRIV_SYS_RES_BIND<br/>
3935 timer_settime() for a one-shot should use cyclic_reprogram()<br/>
3936 cyclic_remove_here() blocked with cyp_rpend of UINT32_MAX<br/>
3937 cyclic processing fails when cy_pend is greater than INT32_MAX<br/>
3967 iconv() blows up when passed (iconv_t)-1<br/>
OS-2409 &#95;init alignment from crti.s needs work<br/>
3735 should include an empty make variable in the default CFLAGS/CCFLAGS<br/>
3844 the build should make source-level debugging easier<br/>
3922 libkvm/mdb should be able to extract symbols from crash dump<br/>
3953 Calling ::list without specifying the name of the next member causes mdb to core dump<br/>
3926 multiple extern map file definitions corrupt symbol table entry<br/>
3917 panic in turnstile_block() on unowned mutex<br/>
OS-2408 iconv() blows up when passed (iconv_t)-1<br/>
backout OS-2409 &#95;init alignment from crti.s needs work (missing crtn)<br/>
3942 inject sanity into ipadm tcp buffer size properties<br/>
3943 &#95;snd_lowat_fraction tcp tunable has no effect<br/>
3939 parent rn_lock being held across calls to rc_hold<br/>
OS-2409 &#95;init alignment from crti.s needs work<br/>
3918 "pargs &#45;l" dies on incomplete core dumps<br/>
3919 mdb/pmap should show unresolved map names on core dumps<br/>
3920 executable mapping in core dump misreported when file isn't found<br/>
3921 Pfindexec() finds wrong binary, wreaking havoc<br/>
348 ZFS should handle DKIOCGMEDIAINFOEXT failure<br/>
3902 Race between ipmi_submit_driver_request() and kcs_loop()<br/>
3882 Remove xmod &amp; friends (fix sparc)<br/>
3909 "zfs send &#45;D" does not work<br/>
3834 incremental replication of 'holey' file systems is slow<br/>
3888 zfs recv &#45;F should destroy any snapshots created since the incremental source<br/>
3934 project reference count leak in tasksys_settaskid()<br/>
OS-2366 ddi_periodic_add(9F) is entirely rubbish<br/>
STOR-111 RAID-Z crash dump improvements from code review comments<br/>
3778 1000BASE-LX support in ixgbe<br/>
3856 want FW config version number for igb and ixgbe<br/>
3913 there is no dialup, only zuul<br/>
3894 zfs should not allow snapshot of inconsistent dataset<br/>
3875 panic in zfs_root() after failed rollback<br/>
3706 mdb segfault when random address is passed to "list" walker<br/>
3911 mdb is unable to display recursive stack<br/>
1986 libima misuses gethostname<br/>
OS-2288 there is no dialup, only zuul</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>OS-2412 64-bit iconv modules should match 32-bit</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-July25%2C2013"></a>July 25, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>smartos-live#238 Global zone lacks svc:/network/nfs/mapid:default<br/>
FWAPI-71: "fwadm vms" throws an error when rule references an unknown VM<br/>
OS-2387 Bump DEFAULT_MAXPID to 99999<br/>
joyent/smartos-live#239: nictagadm doesn't properly handle comments in config file<br/>
FWAPI-68: fwadm: want to be able to find VMs affected by a rule<br/>
FWAPI-56: Remove accidentally checked-in binary<br/>
FWAPI-56: Add microtime to node_modules<br/>
FWAPI-69: fw.js: expose function for getting remote rule targets<br/>
FWAPI-56 Add node-microtime (0.3.3) 9bbd4002c3b3c5ba246810feae37bd69352383f6<br/>
smartos-live#238 Global zone lacks svc:/network/nfs/mapid:default<br/>
OS-2393 crtn was not properly updated for the crti changes<br/>
OS-2392 i386 ctri.s does not provide proper stack alignment<br/>
OS-2387 Bump DEFAULT_MAXPID to 99999<br/>
OS-2386 Pfindexec() finds wrong binary, wreaking havoc<br/>
3895 {tcp,udp}_{largest,smallest}_anon_port should reality-check<br/>
3869 tcp anon port calculation wrong<br/>
OS-2345 panic in zfs_root() due to NULL z_os (fix refcnt)<br/>
OS-2378 OS-2358 fix causes snapshot &#45;r to fail during recv<br/>
3893 lvm: incorrect flag handling<br/>
OS-2377 Make zfs-io-priority 0 mean that zone isn't subject to I/O throttling<br/>
OS-2345 panic in zfs_root() due to NULL z_os<br/>
3853 &#95;_cplusplus change and headers incompatipility with clang<br/>
3849 implement _<em>cxa_atexit/</em>&#95;cxa_finalize<br/>
3887 Enlarge data buffer in digest/mac to boost performance<br/>
OS-2373 elfcore() can induce panic in bcopy()<br/>
3877 fast reboot does not work with extended partition<br/>
OS-2371 push for OS-2271 omitted two files</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>OS-2390 illumos-extra g11n build breaks if MAKE is set</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-July11%2C2013"></a>July 11, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2363 use existing disk_driver or nic_driver values on update when available.<br/>
OS-2363 keep disk_driver and nic_driver properties and use .model from first disk/nic if missing.<br/>
OS-2295 Users should be able to lower nice value of processes within a zone.<br/>
OS-2346 bump ringbuffer messages to 512 to help track down problems.<br/>
OS-2357 fix vmadm lookup when no &#45;j and &#45;o to not lookup attributes it doesn't need.<br/>
OS-2353 add support for mounting /checkpoints for joyent and joyent-minimal<br/>
OS-2323 hang in 'imgadm import ... IMAGE-UUID'<br/>
IMGAPI-95: imgadm create &amp; imgadm publish (for non-KVM images and VMs)<br/>
OS-2349 /etc/profile executes /usr/sbin/quota, which is O(mountpoints)<br/>
OS-2284 fix vmadm deletion of non-existent VM</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>3839 AHCI: WARNINGs should be replaced by ASSERTs<br/>
3878 blkdev needs to support DKIOCGMEDIAINFOEXT<br/>
OS-2368 freed zombie sdev_node still in directory cache<br/>
OS-2369 sdev_shadow_node slept through a vn_rele<br/>
OS-2356 mdb should support embedded dmods in core dumps<br/>
OS-2295 Users should be able to lower nice value of processes within a zone.<br/>
OS-2367 privileges.5 man page missing PRIV_SYS_RES_BIND<br/>
OS-2312 cron ran the same task twice at the same time<br/>
3866 panic in idm module<br/>
3867 stmfCreateLu failed: GUID_IN_USE<br/>
3868 iscsi target not accepting any new connections<br/>
OS-2359 svc.startd dies in utmpx_postfork()<br/>
3862 stmf + kstat = kernel panic<br/>
3863 stmf_itl_task_start() must check for ilu-&gt;ilu_kstat_io is non-null<br/>
3864 memory leak in the iSCSI code<br/>
3861 tcp buffer size tunables for iscsi connections (fix sizeof calls)<br/>
OS-2358 zfs should not allow snapshot of inconsistent dataset (fix bogon)<br/>
OS-2358 zfs should not allow snapshot of inconsistent dataset<br/>
3809 Recent libc change breaks Solaris 10 Branded Zone Support<br/>
3861 tcp buffer size tunables for iscsi connections<br/>
3836 zio_free() can be processed immediately in the common case<br/>
3775 Upstreaming of ALUA use-after-free fixes from Nexenta<br/>
OS-2351 zone boot crosscheck_zonepaths is O(N^2)<br/>
OS-2328 zone boot failed: could not open master side of zone console<br/>
OS-2349 /etc/profile executes /usr/sbin/quota, which is O(mountpoints)<br/>
OS-2341 need a way to disable hsfs use in a zone<br/>
OS-2350 zoneadmd stuck in sdev</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-June27%2C2013"></a>June 27, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2346: vmadm crash on us-east-3 during update<br/>
FWAPI-59: fwadm get should only output JSON<br/>
NET-217: 4-space indents<br/>
OS-2268 smartos-live configure misses some default packages<br/>
OS-2344 configure should accept no for ILLUMOS_ENABLE_DEBUG<br/>
OS-2332 filewait needs to wait if file's parent directory does not exist when we start watching.<br/>
OS-2325 Revert imgadm changes exacerbating this bug<br/>
OS-2315 imgadm fails on images.joyent.com with SSL certificate failure<br/>
OS-2314 fix path for metadata socket in zoneinit's 00-mdata.sh, and also fix to using correct mdata:fetch start method so we have correct path there too.<br/>
OS-2324 "mdata-get sdc:datacenter_name" returns no value<br/>
IMGAPI-95: imgadm create &amp; imgadm publish (for non-KVM images and VMs)<br/>
HEAD-678: Need persistent IPF rules functionality in Headnode<br/>
OS-1950: Need log rotation on /var/log/fw files<br/>
OS-2307 '/lib/sdc/config.sh &#45;json' should be fast when config hasn't changed<br/>
OS-2297: Add allowed_ips to vmadm man page</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>OS-2350 zoneadmd stuck in sdev<br/>
OS-1994 Missing various liblgrp manual pages<br/>
OS-2338 ipmi driver wedged in kcs_start_write()<br/>
OS-2342 panic in fop_read on hyprlofs mountpoint<br/>
OS-2317 ::typedef gets confused after defining an invalid type<br/>
OS-2343 ::typedef &#45;l shows anonymous structures<br/>
3814 Support for SATA III<br/>
3815 AHCI: Support for Marvell 88SE9128<br/>
3820 /usr/bin/sed doesn't handle binary files.<br/>
3837 Get rid of custom getln() implementation from whois.c<br/>
3036 Update hwdata to current upstream data<br/>
OS-2336 Include nicstat for network interface statistics<br/>
OS-2318 cron doesn't have CTF<br/>
OS-2333 would like a way to disable NFS client in zones<br/>
3788 /etc/bootrc is defunct and should be removed<br/>
2893 build_osnet should go away<br/>
OS-2320 common.ksh post_unpack function doesn't support sparse zone model<br/>
3843 kstat should handle NULL string values<br/>
3829 fix for 3740 changed behavior of zfs destroy/hold/release ioctl<br/>
OS-1720 kstat &#45;l shows <b>all</b> vnics on the host from a zone, info about physical nics viewable, too<br/>
3822 need getline() and getdelim() manual pages<br/>
3832 AMD E721 workaround panics on KVM<br/>
3828 The string(3c) man page needs restrict keyword for strtok_r()<br/>
3818 zpool status &#45;x should report pools with removed l2arc devices<br/>
OS-2271 'tail &#45;F ...' not resetting the offset of file rotation properly<br/>
3787 gcc4.7 &#95;_cplusplus change incompatibility<br/>
3823 wchar.h and wctype_iso.h incompatibility<br/>
OS-2197 renaming dynamic sdev nodes leads to panic<br/>
OS-2195	sdev dynamic directories can be created multiple times<br/>
OS-2137 sdev vfs refcount assertion violation<br/>
OS-2118 chmod 700 /dev/zcons/&#42; panics the box<br/>
OS-2311 sdev could use some theory statements<br/>
3691 setgroups() needs a sorted GID list for more than 16 groups<br/>
3808 sulogin should reset console to text mode<br/>
OS-2308 kstat(1) woefully inefficient on fully specified kstats</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<p>HVM-778 ship qemu mdb module</p>

<h2><a name="SmartOSChangeLog-June13%2C2013"></a>June 13, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2200 fix update of resolvers when no current resolvers. also fixes 'make check', tests and removes some cruft.<br/>
OS-2297: vmadm: add allowed_ips property for nics<br/>
joyent/smartos-live#223 imgadm should use progbar from npm<br/>
OS-2304 metadata agent needs to reload if cache is stale when loading sdc:resolvers and sdc:routes<br/>
OS-2253 when rebooting many zones, mdata:fetch should not go into maintenance<br/>
OS-2289 make metadata agent files jsl and jsstyle clean<br/>
OS-2290 switch metadata agent to bunyan logging<br/>
OS-2291 cleanup objects for zone when zone deleted<br/>
OS-2292 fix KEYS command to merge internal_metadata creds w/ customer_metadata keys<br/>
OS-2293 upgrade node-zsock to latest upstream<br/>
OS-2135 /etc/rtc_config contains evil<br/>
smartos-live#227 netmask mistakingly required for non-admin network dhcp<br/>
OS-2257 unusable SSL libraries should have different names in the platform<br/>
TOOLS-184: fix intermittent net failures in VM test suite<br/>
OS-2263: 'man vmadm' PROPERTIES section doesn't mention "firewall_enabled" prop/field<br/>
OS-2277: Add network_uuid field to nics<br/>
OS-2275 fix reprovision when quota is 0 (none)<br/>
OS-2274: 'imgadm avail' blows up with "Cannot read property 'length' of undefined" if cannot reach one of the sources<br/>
OS-2249: ipv4-forwarding service always enabled<br/>
OS-2269 mdata:fetch should have dependency on system/rmtmpfiles<br/>
OS-2266 keep quota across reprovision<br/>
OS-2270 destroy old dataset with &#45;r when reprovisioning<br/>
OS-2158 add tests for reprovision<br/>
OS-1963 / smartos-live#135 fix vmadm recv for KVM VMs (thanks MerlinDMC&#33;).<br/>
OS-1103 perform upgrade for old VMs to bring to {v: 1}<br/>
OS-2261 / smartos-live#219 fix KVM autoboot after reboot<br/>
OS-2260 fix regression caused by OS-2059 which broke 'make check' on a clean checkout on OS X.<br/>
FWAPI-53: "too few args to sprintf" error when adding remote VMs with a UUID matching a local VM</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>OS-2302 ipmi driver needs to coordinate access to the dev_list<br/>
OS-2303 illumos 3770 does not properly clean up in ipmi attach<br/>
OS-2301 brand hooks should not be i18n<br/>
3740 Poor ZFS send / receive performance due to snapshot hold / release processing<br/>
OS-2259 ixgbe failed callback message on console during boot<br/>
OS-2239 ill_frag_hash_tbl not allocated for loopback interfaces<br/>
3749 zfs event processing should work on R/O root filesystems<br/>
3747 txg commit callbacks don't work<br/>
3745 zpool create should treat &#45;O mountpoint and &#45;m the same<br/>
3811 zpool create &#45;o altroot=/xyz &#45;O mountpoint=/mnt ignores the mountpoint option<br/>
3744 zfs shouldn't ignore errors unmounting snapshots<br/>
3743 zfs needs a refcount audit<br/>
3742 zfs comments need cleaner, more consistent style<br/>
3741 zfs needs better comments<br/>
3797 AHCI: Support for ASMedia ASM106x<br/>
3506 Use "hypervisor" CPUID bit to detect hypervisor environment<br/>
3505 Creating LU unconditionally enables write cache on backing store device<br/>
3805 arc shouldn't cache freed blocks<br/>
OS-2257 unusable SSL libraries should have different names in the platform<br/>
OS-2285 platform contains a few broken symlinks<br/>
OS-2281 mdb_v8 unable to print objects on 3.14.5.x<br/>
OS-2280 zonememstat reports 0 rss for kvm-branded zones<br/>
3799 ddi_ffs(9f): typo in function prototype<br/>
OS-2235 prstat &#45;V swap summary is large compared to prstat &#45;VZ<br/>
OS-2249: ipv4-forwarding service always enabled<br/>
3137 L2ARC compression<br/>
3795 find does not support &#45;path or &#45;ipath<br/>
3798 Typo in passwd(1) man page<br/>
3664 pkg/Makefile openssl logic should be removed<br/>
OS-2248: Do not enable network/routing/route if no default route is set</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>OS-2286 lldpd doesn't understand datalinks<br/>
OS-2287 lldpd's system name TLV is not recognised<br/>
OS-2257 unusable SSL libraries should have different names in the platform</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-May30%2C2013"></a>May 30, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2225 don't expose internal_metadata via 'sdc:internal_metadata' prefix.<br/>
OS-2245: upgrade platform bunyan to 0.21.3 for `bunyan &#45;p * &#45;l error`<br/>
3701 Chelsio Terminator 4 NIC driver for illumos<br/>
FWAPI-51: add additional pass out fallback for icmp<br/>
FWAPI-49: Do not require owner_uuid for validating firewalls for VMs<br/>
FWAPI-49: firewall payload validation failing due to missing VM data<br/>
OS-2237 add zpool creation time to sysinfo<br/>
OS-2234 / smartos-live#215 switch default vga driver to 'std'</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>3680 Want a library to allow programatic access to the pci database (fix sparc pkg)<br/>
3701 Chelsio Terminator 4 NIC driver for illumos (fix sparc pkg)<br/>
3676 dt_print_enum hardcodes a value of zero (fix sparc lint)<br/>
OS-2229 panic in turnstile_block() on unowned mutex<br/>
3702 nfs4_clnt.h: Typo pathhconf<br/>
3751 ALUA mode: "/usr/demo/comstar/bin/aluaadm enable 1" sets "ALUA Node" = 0<br/>
3770 ipmi drivers hangs due to attach/detach/attach cycle<br/>
OS-2185 nightly dmake check should look for the new dmake<br/>
3699 zfs hold or release of a non-existent snapshot does not output error<br/>
3739 cannot set zfs quota or reservation on pool version &lt; 22<br/>
3621 ZFS LU stuck in the offlining state<br/>
3701 Chelsio Terminator 4 NIC driver for illumos<br/>
3630 NFS server should not allocate oversized buffers<br/>
3771 kmdb hangs when reading an invalid address<br/>
3717 a README should explain libc's use of 'protected', the potential existence of synonym symbols, etc.<br/>
3769 Implement SOCK_NONBLOCK flag to socket()<br/>
2987 Add destination address to hash computation in mac fanout<br/>
3713 Implement accept4() (fix lint)</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-May15%2C2013"></a>May 15, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2211: Set umask instead of chmod'ing, set metdata.sock smartdc directory usable only by root<br/>
OS-2224: imgadm "-E" option for machine parsable error<br/>
OS-2213 switch metadata agent to using internal_metadata for &#42;_pw keys to support older datasets.<br/>
OS-2223 don't fail reprovision when /zones/&lt;uuid&gt;/cores is not mounted.<br/>
OS-2222 make reprovision more robust by forcing zfs renames and undoing transition if we fail.<br/>
OS-2218 'imgadm list' misses incremental images<br/>
OS-2211: Change the default metadata sock permisisons.<br/>
OS-2208 tools/customize should not chroot into the ramdisk<br/>
FWAPI-47: "FROM any" should filter on destination port, not source<br/>
OS-2201 build_usb erroneously checks for mkisofs<br/>
OS-2194 allow resolvers to be an empty array and in that case, write resolv.conf with no 'nameserver' lines.<br/>
OS-2154 use @final snapshot when exists for an image, but don't remove @final when destroying VM</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>OS-2220 SOCK_NONBLOCK is incomplete, breaks node<br/>
OS-2170 want 64-bit v8 mdb dmod (add missing file)<br/>
OS-2170 want 64-bit v8 mdb dmod<br/>
OS-2190 libkvm/mdb should be able to extract symbols from crash dump<br/>
OS-1983 tmpfs force unmount causes illegal VFS_RELEs<br/>
OS-2199 nss_dns.so.1 returns no records found IPv4/6 is requested but only v6 exists<br/>
OS-2154 sngl brand should clone from @final when it exists.<br/>
3713 Implement accept4()<br/>
3714 Implement pipe2()<br/>
3715 Implement dup3()<br/>
3716 Implement mkostemp() and mkostemps()<br/>
3719 so_socketpair syscall should preserve FD_CLOEXEC flag<br/>
3722 link-editor is over restrictive of R_AMD64_32 addends</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>OS-2215 curl uses LD_LIBRARY_PATH to the proto area<br/>
OS-2207 openlldp should remove files before it installs</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-May02%2C2013"></a>May 02, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2188 add vm_logs name for vm logadm.conf entry, also bump to 1 week of logs.<br/>
OS-2187 add vm-version/v to vm objects so we can handle upgrades which require updates to properties.<br/>
OS-2184 fix reprovision regression.<br/>
OS-2183 fix 'make check' cleanliness regression introduced by IMGAPI-152.<br/>
IMGAPI-152: rev imgadm to 2.0.3 for the @final change<br/>
IMGAPI-152 imgadm should ensure that we always have an @final snapshot of an imported dataset<br/>
NET-203: Networks should support additional routes<br/>
OS-2179: restart mdata:fetch on update that modifies one of the properties mdata:fetch writes out<br/>
OS-1808 change to &#45;S 1g vs &#45;s 100m since we have &#45;b script to populate the logs.<br/>
OS-2175 have mdata:fetch write out new /etc/resolv.conf if required data is in metadata.<br/>
OS-1808 move VM.js logs to /var/log/vm/logs and rotate to /var/log/vm/vm.log<br/>
OS-2051 serial console login should set TERM appropriately<br/>
OS-2172: fix typo causing undeclared var<br/>
OS-2172: imgadm + source URL with hostname + GZ DNS changes + internal DNS as first resolve.conf entry = broken<br/>
OS-2116 dns in net/physical<br/>
OS-2164 reprovision needs to run some of the commands from brand's install script.<br/>
OS-2161 want workaround for joyent/pkgsrc#50<br/>
HEAD-886 add experimental support for reprovisioning for some types of VM.<br/>
OS-2125 multilib: gcc package name has changed; configure is lost<br/>
FWAPI-29: Should be able to target rules by tag_name=value<br/>
OS-2072 fix cases where disks.*.image_size was not passed but was available from imgadm.</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>OS-2160 want FW config version number for igb and ixgbe<br/>
OS-2186 ship pcitool<br/>
OS-2178 cscope-fast clobber misses scanner.c<br/>
OS-2115 /etc/resolv.conf only handles a fixed number of DNS resolvers (fix debug)<br/>
OS-2001 disk-monitor should activate fault/fail indicators (fix build)<br/>
OS-2176 disk-lights broke the build<br/>
OS-2169 need JCP-1102 topo map<br/>
OS-2001 disk-monitor should activate fault/fail indicators<br/>
OS-1965 need manpage for getline(3C), getdelim(3C)<br/>
OS-2171 htonll and ntohll manual pages mistakingly checked in<br/>
3705 stack overflow due to zfs lz4 compression<br/>
OS-2128 a9ff841f brought in lint libraries, is out of order<br/>
OS-2133 panic in mptsas_restart_hba()<br/>
3642 dsl_scan_active() should not issue I/O to determine if async destroying is active<br/>
3643 txg_delay should not hold the tc_lock<br/>
OS-2115 /etc/resolv.conf only handles a fixed number of DNS resolvers<br/>
OS-2148 suspect nscd is not honoring DNS TTLs<br/>
OS-2149 want getifaddrs manual page<br/>
3724 kstat reports idle time as io_wait, kernel as pio_wait, etc<br/>
3616 SHF_GROUP sections should not be discarded via other COMDAT mechanisms<br/>
3709 need sloppy relocation for GNU .debug_macro<br/>
667 cp support for &#45;a flag</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>NET-209 want bidirectional LLDP facility<br/>
OS-2177 perl uses dtrace &#45;G with no probe sites<br/>
OS-2173 libmakestate shenanigans are janky<br/>
OS-2123 multilib: gcc can't install in parallel<br/>
OS-2124 multilib: gcc needs to know that /opt/local/lib isn't in the runpath<br/>
OS-2156 handle curl CVE-2013-1944<br/>
OS-2152 illumos-extra make prefix.patch confuses its arguements</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<p>HVM-774 qemu uses dtrace &#45;G with no probe sites</p>

<h2><a name="SmartOSChangeLog-Apr18%2C2013"></a>Apr 18, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2109 make description of delegate_dataset more clear where the datatset will show up.<br/>
OS-2120 cleaned up message formatting to indicate that uuids are VMs<br/>
OS-2146 fix regression with 'vmadm lookup' without additional arguments.<br/>
OS-2143 use child_process.spawn instead of child_process.execFile to prevent out of memory condition when loading many zones.<br/>
OS-2144 add zonepath to fw_fields list and prevent looping test on error.<br/>
joyent/smartos-live#201 fix crash on 'vmadm lookup disks.*.model=virtio'<br/>
OS-1989 VM.js should only load properties it needs to satisfy request.  Also adds 'vmadm lookup &#45;j &#45;o &lt;fields&gt;'.<br/>
NET-204: Use the mounted USB config when the copy isn't available<br/>
NET-204: netbooted nodes should be able to add / delete nic tags without a reboot<br/>
joyent/smartos-live#161 NICs not persisting across reboots<br/>
OS-2119 configure ought to run pkgin as root<br/>
3500 Support LSI SAS2008 (Falcon) Skinny FW for mr_sas(7D)<br/>
OS-2060 /etc/release entries for components are out of date</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>OS-2150 project reference count leak in tasksys_settaskid()<br/>
3687 fopen() O_CLOEXEC support via the "e" flag<br/>
OS-2140 ::dtrace can yield no output<br/>
OS-2139 need to ship libdtrace_forceload.so<br/>
OS-2131 dtrace(1M) should never create DOF with empty probes section<br/>
OS-2122 Only probes from the first DTrace object file will be included<br/>
3708 Fast reboot support in ixgbe<br/>
3666 Implement SOCK_CLOEXEC flag to socket()<br/>
3673 core dumping is abysmally slow<br/>
3671 left behind enemy lines, agent LWP can go rogue<br/>
3670 add visibility into agent LWP's spymaster<br/>
3679 prtconf should print out PCI database information<br/>
3680 Want a library to allow programatic access to the pci database<br/>
3668 add "%H" to mdb_printf() for human-readable sizes (fix kmdb)<br/>
OS-2132 mdb_printf()'s "%H" must not use floating point under &#95;KMDB<br/>
3674 onbld Checks should not query opensolaris.org<br/>
3645 dmu_send_impl: possibilty of pool hold leak<br/>
3692 Panic on zfs receive of a recursive deduplicated stream<br/>
3668 add "%H" to mdb_printf() for human-readable sizes<br/>
OS-2113 multiple extern map file definitions corrupt symbol table entry<br/>
3650 mdb global symbol tab completion should find all symbols<br/>
3651 mdb_readsym() and friends should find all symbols<br/>
3652 convert ::spa and ::spa_vdevs to use mdb_ctf_vread()<br/>
3653 userland ::whatis always complains about "umem_internal_arena" symbol<br/>
3654 zdb should print number of ganged blocks<br/>
3655 ::rrwlock and ::refcount print errors on non-debug kernels<br/>
3656 remove unused function zap_cursor_move_to_key()<br/>
3657 mdb_ctf_vread() should allow conversion of pointer to uintptr_t<br/>
3675 DTrace print() should try to resolve function pointers<br/>
3676 dt_print_enum hardcodes a value of zero<br/>
3677 /dev/ipnet can duplicate packets<br/>
3683 pfiles shouldn't try to trace itself<br/>
3684 pfiles crashes on processes with no files<br/>
3685 getsockname should set the sa_family_t for unbound unix domain sockets<br/>
3686 pfiles shows incorrect socket information on some getsockname calls<br/>
3672 mac_unregister does not clear mi_dstaddr_set<br/>
3682 /usr/bin/head should implement &#45;c &#45;q and &#45;v<br/>
3500 Support LSI SAS2008 (Falcon) Skinny FW for mr_sas(7D)</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>OS-1886 apply libcurl sasl patch</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-Apr04%2C2013"></a>Apr 04, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2086 smartos-live gmake clean misses proto.boot<br/>
OS-2102 smartos-live should support generating pkgsrc packages<br/>
OS-2103 Need packages for various build tools<br/>
OS-2104 configure needs to install new smartos-live build packages<br/>
OS-2105 missing a pkgin update can lead to weird behavior<br/>
OS-2106 configure needs to point ON in the right direction<br/>
OS-2061 make VM.start a NO-OP when the VM is already running.<br/>
OS-2089 fix sysinfo man page wrt CPU cores.<br/>
OS-920 VM.js should ensure paths are safe before accessing files in zoneroot, and should avoid after zone is booted the first time.<br/>
FWAPI-41: Allow tcp / udp "port all"<br/>
FWAPI-40: CLI: Allow specifying the rule in command-line args<br/>
FWAPI-39: All VMs need to allow pings from any by default<br/>
FWAPI-35: ipf rules should more judicious in keeping state<br/>
OS-2079 imgadm won't import from a DSAPI source: ActiveImageNotFound error<br/>
smartos-live#190 Fix imgadm not importing from DSAPI sources<br/>
smartos-live#188 Fix handling of imgadm sources without leading 'http://'<br/>
joyent/smartos-live#190: 'imgadm update' broken<br/>
FWAPI-30: wildcard filtering does not work</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>3665 Implement O_CLOEXEC as an open() flag<br/>
OS-2094	ON tools should honor $MAKE<br/>
OS-2095 cmd/refer Makefile is a bit bogus<br/>
OS-2096 xref hardcodes its path<br/>
OS-2097 lex should check $origin for support files<br/>
OS-2098 yacc should check $origin for support files<br/>
OS-2099 remove OS-1583 workaround<br/>
OS-2100 ndmp makefiles need to use $(RPCGEN)<br/>
OS-2101 Need a way to specify ast binary directory<br/>
918 Need better IP fanout (esp. with VLANs present)<br/>
OS-2070 mdb_v8 should autoconfigure based on DYNSYM, not SYMTAB<br/>
OS-2071 executable mapping in core dump misreported when file isn't found<br/>
OS-2077 agent LWP evades detection from mdb<br/>
3638 ld confuses files with group sections and files that should lazy load<br/>
3667 Allow ixgbe to use unsupported SFP modules<br/>
OS-2075 ptime &#45;p could support multiple processes<br/>
OS-2084 left behind enemy lines, agent LWP can go rogue<br/>
OS-2085 add visibility into agent LWP's spymaster<br/>
OS-2081 GRUB console device help message needs to be more helpful<br/>
3619 cp &#45;p clobbers permissions/ownership following symbolic links<br/>
3660 tcp_slow_start_&#42; tunables should allow increasing the initial congestion window<br/>
OS-2083 Remove mDNS syslog spam<br/>
OS-2076 grub corrupts stack while installing stage1.5<br/>
OS-2069 elfdump should be 64-bit<br/>
OS-2062 mdb/pmap should show unresolved map names on core dumps<br/>
3639 zpool.cache should skip over readonly pools<br/>
3640 want automatic devid updates<br/>
3641 want a histogram of compressed block sizes<br/>
joyent/illumos-extra#9 OS-1588 breaks the build.<br/>
OS-2064 dt_print_enum hardcodes a value of zero<br/>
OS-2067 kmem_cache_create manual page uses &#95;fini instead of &#95;init<br/>
OS-2068 mac_unregister does not clear mi_dstaddr_set<br/>
3618 ::zio dcmd does not show timestamp data</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>OS-1972 ntp server check could be improved<br/>
OS-2111 dmake not properly resetting conditoinal variables<br/>
OS-2091 add open source dmake to illumos-extra<br/>
OS-2092	illumos-extra components should use open source dmake<br/>
OS-2093 illumos-extra components need to use pkgsrc sgstools<br/>
joyent/illumos-extra#9 OS-1588 breaks the build.<br/>
OS-1901 lgrpinfo incorrectly shows DRAM information</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-Mar21%2C2013"></a>Mar 21, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-2059 smartos-live shouldn't pretend it supports building on OSX<br/>
OS-2054 want platform to deliver GRUB in a separate bundle<br/>
OS-2058 Missing /etc/driver_aliases entry for arcmsr 17d3,1880<br/>
OS-1970 Add support for the Areca 1882<br/>
OS-2054 want platform to deliver GRUB in a separate bundle<br/>
OS-2053 'imgadm install' has poor error message for missing required opts<br/>
IMGAPI-129 AddImageIcon "UploadError" details don't make it through to the CLI<br/>
OS-2037 illumos.sh needs to know the path to AR<br/>
OS-2035 illumos configure should find elfdump, lorder, mcs, nm, strip, and tsort in /usr<br/>
OS-2030 upgrade to bunyan 0.20.0 which fixes regression.<br/>
joyent/smartos-live#183 disklayout (crash) / diskinfo (segfault)<br/>
OS-2026 Don't show 'Setup' property inside a zone or on non-SDC.<br/>
OS-2025 Upgrade to bunyan 0.19.0<br/>
OS-1827 add man page for sysinfo(1m)<br/>
OS-2019 joyent brand should support optional processor sets instead of cpu caps<br/>
IMGAPI-126 ChecksumError reports incorrect MD5 sums<br/>
OS-2022 improve imgadm import error handling for corrupt download<br/>
OS-2014 raise timeout in attempt to get VM tests passing.<br/>
IMGAPI-112 imgadm v2 considers import of already existing image an error<br/>
IMGAPI-114 imgadm v2 SourcePing error message doesn't give any details<br/>
IMGAPI-113 imgadm v2 allows you to specify the same source twice with and without a '/'<br/>
IMGAPI-114 imgadm v2 SourcePing error message doesn't give any details<br/>
IMGAPI-111 imgadm v2 blows up with "TypeError: Cannot read property 'size' of undefined" on import<br/>
OS-2011 make vmadm more helpful when you pass in invalid JSON.<br/>
OS-1773 update last_modified timestamp for a VM after create-snapshot or delete-snapshot<br/>
OS-1981: enabling / disabling the firewall for a VM ignores remote VMs</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>OS-1177 FMA/SMF notify and FMA agent components depend on nonexistent Net-SNMP<br/>
OS-1970 Add support for the Areca 1882<br/>
OS-2054 want platform to deliver GRUB in a separate bundle<br/>
OS-1928 parent rn_lock being held across calls to rc_hold<br/>
OS-2052 prctl broken due to missing libsaveargs.so.1<br/>
OS-2031 fmtopo &#45;P flag does not appear to set properties<br/>
3544 save-args matcher could be considerably more robust<br/>
3545 save-args matcher should accept saves may be out-of-order<br/>
OS-1998 need topology map for Richmond-A disks, etc<br/>
OS-1997 mpt_sas: expose LED controls to libtopo<br/>
3620 Corruption of the `xprt-ready' queue in svc_xprt_qdelete()<br/>
OS-2009 default ipf state table size is too small<br/>
OS-2029 upgrade: 6.5 portal zone net config incompatible with vmadm<br/>
3567 dtrace print() doesn't play well with ::dtrace<br/>
OS-2027 uninitialised variable trashes command line on coal<br/>
2986 nfs: exi refcounter leak at rfs3_lookup<br/>
Back out hg changeset 829c00a55a37, bug 2986  &#8211;  introduces vulnerability<br/>
3623 kstat must accept partial stat specification<br/>
OS-2013 psrset should support specifying a zone to bind<br/>
OS-2018 zoneadmd should export all attributes to brand statechange scripts<br/>
OS-2008 GZ per-zone /dev/zvol access can make zvol hierarchy can show up in every zone<br/>
3606 zpool status &#45;x shouldn't warn about old on-disk format<br/>
3604 zdb should print bpobjs more verbosely (fix zdb hang)<br/>
3602 mdb should tab complete global symbols<br/>
OS-1882 full tmpfs can cause GZ svc.configd to die and not be restartable<br/>
OS-1764 core dumping is abysmally slow<br/>
OS-1987 disks in zpools never go away when pulled<br/>
3598 want to dtrace when errors are generated in zfs<br/>
OS-1996 mpt_sas: allow physical topology enumeration in libtopo<br/>
3517 importing pool with autoreplace=on and "hole" vdevs crashes syseventd</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>OS-2032 bind should find nm in /usr/bin<br/>
OS-2033 illumos-extra install.subr should not reference /usr/ccs for strip<br/>
OS-2034 libm should find ld, mcs, and strip in /usr<br/>
OS-2023 update to latest abort_on_uncaught_exception.patch</p>

<p>kvm<br/>
&#45;------&#45;</p>


<p>HVM-770 ioapic should return zero reads for bogus pins</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-Mar07%2C2013"></a>Mar 07, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-1865 keep output from zonecfg/zoneadm commands so we can track failures coming from brand scripts.<br/>
OS-1978 don't spew error about zone not existing when we're confirming it was deleted.<br/>
OS-2000 SATA hotplug should have nice things<br/>
OS-1995 VM tests should use imgadm to ensure images are installed<br/>
OS-1866 validate should reject payloads that contain invalid image_uuids<br/>
OS-1874 vmadmd should ignore zone transitions that it doesn't care about.<br/>
OS-1962 / OS-1791 stopping a non-running VM should be a noop.<br/>
joyent/smartos-live#180 drop faulty logic sanity checks for image name from zfs origin<br/>
OS-1980: vmadm update: setting firewall_enabled doesn't enable / disable ipf<br/>
OS-1974 / OS-1834 fix problems with many snapshots and serialize zfs list commands.<br/>
OS-1974 don't lose data when there are many snapshots<br/>
OS-1834 don't run multiple 'zfs list' commands at the same time<br/>
OS-1964 Fix log flushing in vmadm<br/>
OS-1971 fix case where data comes in while we're cleaning up zoneevent watcher and VM.js throws uncaught exception.<br/>
OS-1954 node_zfs timeout too low<br/>
OS-1951 imgadm: specific exit status for ImageNotInstalled from 'imgadm info' et al<br/>
OS-1953 imgadm should only run for root in the GZ<br/>
OS-1947 add dependency for metadata agent on filesystem/local<br/>
OS-1943: `imgadm sources &#45;a <a href="https://127.0.0.1">https://127.0.0.1</a> &#45;vvv` crash<br/>
OS-1941: 'imgadm import UUID' broken, and make check</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>OS-1977 tmpfs_minfree's bowl of porridge is now too hot<br/>
OS-1988 Make ldi_ev_remove_callbacks safe to use in LDI callbacks Reviewed by: Robert Mustacchi &lt;rm@joyent.com&gt;<br/>
3530 ::smbsess prints wrong IP addresses in verbose mode, has no idea about IPv6<br/>
3603 panic from bpobj_enqueue_subobj()<br/>
3604 zdb should print bpobjs more verbosely<br/>
3551 hvm_sd module missing dependencies on scsi and cmlb<br/>
3582 zfs_delay() should support a variable resolution<br/>
3584 DTrace sdt probes for ZFS txg states<br/>
OS-1988 Make ldi_ev_remove_callbacks safe to use in LDI callbacks<br/>
OS-1910 want grub support for cross-menu OS console variable<br/>
OS-1986 /usr/bin/head should implement &#45;c &#45;q and &#45;v.<br/>
3530 ::smbsess prints wrong IP addresses in verbose mode, has no idea about IPv6<br/>
3603 panic from bpobj_enqueue_subobj()<br/>
3604 zdb should print bpobjs more verbosely<br/>
OS-1985 ::mptsas should show slot/enclosure for targets<br/>
OS-1966 fix DEBUG build<br/>
3551 hvm_sd module missing dependencies on scsi and cmlb<br/>
OS-1909 pfiles shows incorrect socket information on some getsockname calls<br/>
OS-1979 getsockname should set the sa_family_t for unbound unix domain sockets<br/>
3582 zfs_delay() should support a variable resolution<br/>
3584 DTrace sdt probes for ZFS txg states<br/>
OS-1815 3curses manual pages missing<br/>
OS-1976 tmp_inactive uses memory after freeing<br/>
OS-1973 stub out fs and ss limit feature compatibility<br/>
OS-1969 zone boot failed: could not open slave side of zone console<br/>
OS-1929 pfiles shouldn't try to trace itself OS-1931 pfiles crashes on processes with no files<br/>
OS-1528 wheels fell off dtrace.h during a merge<br/>
OS-1929 pfiles shouldn't try to trace itself<br/>
OS-1931 pfiles crashes on processes with no files<br/>
815 Need ipadm(1M) manual page<br/>
3464 zfs synctask code needs restructuring<br/>
3426 assertion failed: irq &lt; 16 on VMware hardware version 9 (apix related)<br/>
3581 spa_zio_taskqZIO_TYPE_FREEZIO_TASKQ_ISSUE&#45;&gt;tq_lock is piping hot<br/>
3543 Feature flags causes assertion in spa.c to miss certain cases<br/>
3588 provide zfs properties for logical (uncompressed) space used and referenced<br/>
3552 condensing one space map burns 3 seconds of CPU in spa_sync() thread (fix race condition)<br/>
OS-1528 wheels fell off dtrace.h during a merge<br/>
backout OS-1566 filesystem limits for ZFS datasets: merge<br/>
815 Need ipadm(1M) manual page<br/>
3464 zfs synctask code needs restructuring<br/>
3426 assertion failed: irq &lt; 16 on VMware hardware version 9 (apix related)<br/>
OS-1945 "pargs &#45;l" dies on incomplete core dumps<br/>
OS-1956 mdb_v8 can't display strings on 3.16.14.x<br/>
OS-1957 ::findjsobjects displays too many false positives<br/>
OS-1959 ::v8print doesn't properly process "char" type<br/>
OS-1960 ::findjsobjects &#45;l should list all representative objects<br/>
3581 spa_zio_taskqZIO_TYPE_FREEZIO_TASKQ_ISSUE&#45;&gt;tq_lock is piping hot<br/>
3543 Feature flags causes assertion in spa.c to miss certain cases<br/>
OS-1947 add dependency for zones on metadata<br/>
3588 provide zfs properties for logical (uncompressed) space used and referenced<br/>
OS-1939 ::findjsobjects array detection suffers from false positives<br/>
OS-1940 ::findjsobjects &#45;p/-c should allow objects to be specified<br/>
OS-1944 ::findjsobjects should sort by product of properties and instances<br/>
3557 dumpvp_size is not updated correctly when a dump zvol's size is changed<br/>
3558 setting the volsize on a dump device does not return back ENOSPC<br/>
3559 setting a volsize larger than the space available sometimes succeeds<br/>
3560 dumpadm should be able to remove a dump device<br/>
3578 transferring the freed map to the defer map should be constant time<br/>
3579 ztest trips assertion in metaslab_weight()<br/>
3501 mdb: ::thread &#45;d needs the SWITCH column<br/>
3496 sysevent runtime files are under /var/run<br/>
3431 sharectl prints garbage when it failed<br/>
3412 The ascii art in nfs4.h needs update<br/>
1927 nfs4 stale clientid loop (OI server, Linux client)<br/>
3515 sd gives RMW warnings for reads<br/>
3552 condensing one space map burns 3 seconds of CPU in spa_sync() thread<br/>
3564 spa_sync() spends 5-10% of its time in metaslab_sync() (when not condensing)<br/>
3566 recursive mutex panic in specfs<br/>
3561 arc_meta_limit should be exposed via kstats<br/>
3116 zpool reguid may log negative guids to internal SPA history<br/>
3537 want pool io kstats<br/>
3523 SMB NT Notify returning too soon<br/>
3223 SMB FindFirst/FindNext don't fill in Last Name Offset<br/>
374 cron should send more useful mail<br/>
3529 iostat should display time used by dtrace<br/>
3522 zfs module should not allow uninitialized variables<br/>
3503 usba doesn't initialize cc_no_resources, causes gibberish output in kstat:<br/>
3531 Race between log_sysevent_filename() and log_event_upcall() can cause panic<br/>
3512 rounding discrepancy in sa_find_sizes()<br/>
3513 mismatch between SA header size and layout<br/>
3534 Disable EEE support in igb for I350<br/>
3535 mdb ::print should pretty-print ipaddr_t and friends<br/>
3305 smbfs mount shows password<br/>
3507 Tunable to allow block allocation even on degraded vdevs<br/>
3519 DTrace fails to resolve const types from fbt<br/>
3520 dtrace internal error &#8211; token type 316 is not a valid D compilation token<br/>
3521 clean up dtrace unit tests<br/>
3516 Leftover multidata transmit kernel statistics in ipv6<br/>
3514 Spurious errors setting up new SMB client sessions<br/>
3498 panic in arc_read(): &#33;refcount_is_zero(&amp;pbuf-&gt;b_hdr-&gt;b_refcnt)<br/>
3508 NFS4 data corruption (client side)<br/>
3511 dtrace.c erroneously checks for memory alignment on amd64<br/>
3325 nsmb_close locking and teardown deadlock<br/>
3465 ::walk ... &#124; ::&lt;dcmd&gt; misinterprets input as symbol names<br/>
3466 ::tsd should handle missing/NULL values better<br/>
3467 mdb_ctf_vread() could be more useful<br/>
3468 mdb enhancements for zfs development<br/>
3470 ::whatis does not print callers from KMF_LITE<br/>
3473 mdb_get_module() returns wrong module<br/>
3371 dumpadm &#45;z is not documented in manpage<br/>
3380 zfs man page: documentation for zfs allow is confusing<br/>
3196 ao_gendisp use by make is racey<br/>
3237 r10 is added 2 times to panic info<br/>
3502 panic in smb_server_shutdown (sl_count assertion)<br/>
604 CIFS server should traverse child mount points<br/>
749 "/usr/bin/kstat" should be rewritten in C (fix SPARC build)<br/>
749 "/usr/bin/kstat" should be rewritten in C<br/>
3485 statd is not handling incoming SM_NOTIFY properly when the hostname is not resolvable<br/>
3492 some e1000g devices don't support 15 unicast addresses<br/>
3419 usbftdi needs to support the BeagleBone<br/>
3477 SunSSH config should accept TCPKeepAlive as synonym for KeepAlive<br/>
452 getconf should support NPROCESSORS_&#42;<br/>
3474 tar should support &#45;C on extract<br/>
3035 LZ4 compression support in ZFS and GRUB<br/>
3444 README for usr/src/test<br/>
3445 ZFS tests for restricted aclmode<br/>
3552 condensing one space map burns 3 seconds of CPU in spa_sync() thread (fix race condition)<br/>
3557 dumpvp_size is not updated correctly when a dump zvol's size is changed<br/>
3558 setting the volsize on a dump device does not return back ENOSPC<br/>
3559 setting a volsize larger than the space available sometimes succeeds<br/>
3560 dumpadm should be able to remove a dump device<br/>
3578 transferring the freed map to the defer map should be constant time<br/>
3579 ztest trips assertion in metaslab_weight()<br/>
3501 mdb: ::thread &#45;d needs the SWITCH column<br/>
3496 sysevent runtime files are under /var/run<br/>
3431 sharectl prints garbage when it failed<br/>
3412 The ascii art in nfs4.h needs update<br/>
1927 nfs4 stale clientid loop (OI server, Linux client)<br/>
3515 sd gives RMW warnings for reads<br/>
3552 condensing one space map burns 3 seconds of CPU in spa_sync() thread<br/>
3564 spa_sync() spends 5-10% of its time in metaslab_sync() (when not condensing)<br/>
3566 recursive mutex panic in specfs<br/>
3561 arc_meta_limit should be exposed via kstats<br/>
3116 zpool reguid may log negative guids to internal SPA history<br/>
3537 want pool io kstats<br/>
3523 SMB NT Notify returning too soon<br/>
3223 SMB FindFirst/FindNext don't fill in Last Name Offset<br/>
374 cron should send more useful mail<br/>
3529 iostat should display time used by dtrace<br/>
3522 zfs module should not allow uninitialized variables<br/>
3503 usba doesn't initialize cc_no_resources, causes gibberish output in kstat:<br/>
3531 Race between log_sysevent_filename() and log_event_upcall() can cause panic<br/>
3512 rounding discrepancy in sa_find_sizes()<br/>
3513 mismatch between SA header size and layout<br/>
3534 Disable EEE support in igb for I350<br/>
3535 mdb ::print should pretty-print ipaddr_t and friends<br/>
3305 smbfs mount shows password<br/>
3507 Tunable to allow block allocation even on degraded vdevs<br/>
3519 DTrace fails to resolve const types from fbt<br/>
3520 dtrace internal error &#8211; token type 316 is not a valid D compilation token<br/>
3521 clean up dtrace unit tests<br/>
3516 Leftover multidata transmit kernel statistics in ipv6<br/>
3514 Spurious errors setting up new SMB client sessions<br/>
3498 panic in arc_read(): &#33;refcount_is_zero(&amp;pbuf-&gt;b_hdr-&gt;b_refcnt)<br/>
3508 NFS4 data corruption (client side)<br/>
3511 dtrace.c erroneously checks for memory alignment on amd64<br/>
3325 nsmb_close locking and teardown deadlock<br/>
3465 ::walk ... &#124; ::&lt;dcmd&gt; misinterprets input as symbol names<br/>
3466 ::tsd should handle missing/NULL values better<br/>
3467 mdb_ctf_vread() could be more useful<br/>
3468 mdb enhancements for zfs development<br/>
3470 ::whatis does not print callers from KMF_LITE<br/>
3473 mdb_get_module() returns wrong module<br/>
3371 dumpadm &#45;z is not documented in manpage<br/>
3380 zfs man page: documentation for zfs allow is confusing<br/>
3509 igb should not set alternate mac address on newer models<br/>
3422 zpool create/syseventd race yield non-importable pool<br/>
3425 first write to a new zvol can fail with EFBIG<br/>
3196 ao_gendisp use by make is racey<br/>
3237 r10 is added 2 times to panic info<br/>
3502 panic in smb_server_shutdown (sl_count assertion)<br/>
604 CIFS server should traverse child mount points<br/>
749 "/usr/bin/kstat" should be rewritten in C (fix SPARC build)<br/>
749 "/usr/bin/kstat" should be rewritten in C<br/>
3485 statd is not handling incoming SM_NOTIFY properly when the hostname is not resolvable<br/>
3492 some e1000g devices don't support 15 unicast addresses<br/>
3419 usbftdi needs to support the BeagleBone<br/>
3477 SunSSH config should accept TCPKeepAlive as synonym for KeepAlive<br/>
452 getconf should support NPROCESSORS_&#42;<br/>
3474 tar should support &#45;C on extract<br/>
3035 LZ4 compression support in ZFS and GRUB<br/>
3444 README for usr/src/test<br/>
3445 ZFS tests for restricted aclmode<br/>
3463 agent lwp clobbers amd64 abi stack redzone</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>OS-1990 IPMItool in SDC7 does not support bmc or lanplus interfaces<br/>
OS-1967: bash 'test &#45;x' always returns true</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-Feb21%2C2013"></a>Feb 21, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-1941: 'imgadm import UUID' broken, and make check<br/>
OS-1938 imgadm v2 fails to install image when not connected to Internet<br/>
OS-1937 have vmadm, vmadmd and metadata agent abort on uncaught exception.<br/>
OS-1859 imgadm v2<br/>
OS-1935 update async.js to upstream 1fecb21940135b2ff647a93d1fc83df03b363714<br/>
OS-1933 fix issue where preloadZoneData callback called more than once in some cases.<br/>
OS-1927 ramdisk runs out of inodes<br/>
OS-1924 vmadm should allow filtering by nics.*.nic_tag<br/>
OS-1926 vmadm does not allow filtering by nics.*.vlan_id=0<br/>
OS-1661 vmadm and vmadmd should use node-panic to dump core on uncaught exceptions for post-mortem debugging.<br/>
OS-1923 vmadm create does not validate included firewall payload<br/>
OS-1922 vmadm not exiting with non-zero on errors<br/>
OS-1916 fix validation for image_uuid,image_size,image_name + size,block_size<br/>
FWAPI-17 Don't attempt to install removed rule file<br/>
smartos-live/joyent#177 fix issue with brand joyent not being supported for some datasets due to missing '/' in path.<br/>
FWAPI-17 Don't attempt to install removed parser files<br/>
FWAPI-17 Rename machine to vm<br/>
FWAPI-8 Improve fwadm logging<br/>
OS-1789 set refreservation to prevent overprovisioning KVM disks.<br/>
OS-1229 fix case where brand is undefined in validate.<br/>
OS-1229 / smartos-live#173 expose validate command via vmadm (thanks MerlinDMC)<br/>
OS-1894: Warn, but do not crash, if metadata information is not present<br/>
OS-1851 + OS-1730 VM.reboot should wait until zone is rebooted before returning.<br/>
OS-1903 add support for tracing timers in vmadmd.<br/>
OS-1900 add test to ensure dtrace-provider keeps working correctly.<br/>
OS-1902 fix problems with transition provisioning &#45;&gt; running when using nowait: true<br/>
OS-1900 fix dtrace-provider.js so correct binding is loaded.<br/>
OS-1864 don't accept invalid IP addresses.<br/>
OS-1881 force max_swap to always be &gt;= 256M<br/>
OS-1895 fix problems updating tmpfs when tmpfs size not specified at create time.</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>OS-1906 have sngl brand use files from dataset, remove use of SNGL_BASE tarball.<br/>
3035 LZ4 compression support in ZFS and GRUB<br/>
OS-1908 ::findjsobjects needs to find/process JavaScript arrays<br/>
OS-1913 ::jsprint overflows stack on extremely large objects<br/>
OS-1925 ::jsprint can print spurious members<br/>
OS-1914 ::findjsobjects should be able to find references in bulk<br/>
OS-1934 mdb_v8 should be compiled with MDB_API_VERSION set to 3<br/>
OS-1932 mdb_dcmd_f not defined when MDB_API_VERSION is 3<br/>
OS-1921 GRUB menu scrolling overwrites text<br/>
OS-1915 mdb_modapi should support creating v3 dmods<br/>
OS-1898 would like an mdb_v8 walker to iterate over property values<br/>
OS-1899 ::jsprint should allow more than one optional member<br/>
OS-1904 update banner for 2013<br/>
OS-1897 libtermcap symlinks in /usr/lib are busted<br/>
OS-1889 Using /dev/ipnet in the GZ duplicates packets<br/>
OS-1888 DTrace print() should try to resolve function pointers<br/>
OS-1890 want grub composite console<br/>
OS-1885 deadlock between vnic destroy and kstat read<br/>
OS-1867 mdb_v8's ::jsstack should be able to filter based on function<br/>
OS-1868 should be able to specify a desired frame property to ::jsframe<br/>
OS-1880 ::jsprint should be able to print base address with every property</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>OS-1937 add support for abort_on_uncaught_exception in platform node.<br/>
OS-1918 upgrade node to 0.8.20 with fd patch<br/>
OS-1887 openssl 1.0.1d corrupts data</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-Feb07%2C2013"></a>Feb 07, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;</p>

<p>OS-1813 include files from /opt/custom/etc/rsyslog.d/ to extend rsyslog config for GZ persistently.<br/>
OS-1862 fix documentation for tests.<br/>
OS-1848 + OS-1849 fix validation on create-snapshot, fix tests for KVM.<br/>
OS-1842 switch to Logger.child() for VM actions.<br/>
OS-1798 ON build should use pkgsrc python</p>

<p>illumos<br/>
&#45;------&#45;</p>

<p>OS-1872 zoneadmd parent needs to close open fds<br/>
3422 zpool create/syseventd race yield non-importable pool<br/>
3425 first write to a new zvol can fail with EFBIG<br/>
OS-1861 default tmpfs_minfree is far too low<br/>
OS-1854 mdb_v8's ::jsprint should take an optional member<br/>
OS-1852 mdb_v8 should be able to print dictionary properties on 3.11.10.x<br/>
OS-1840 fmdump shall emit JSON<br/>
OS-1845 newer igb models should not handle alternate mac address<br/>
OS-1843 logadm unnecessarily copies historical logs when "-c" is specified<br/>
OS-1841 logadm test suite fails when running rsyslogd<br/>
OS-1837 logadm should not lock log file for entire duration of copy<br/>
OS-1836 passwd command truncates usernames to 8 chars by default (overflow)<br/>
OS-1836 passwd command truncates usernames to 8 chars by default<br/>
OS-1799 stage-licenses should only be hit when building packages<br/>
OS-1800 onbld python tools shouldn't hardocde /usr/bin/python<br/>
OS-1801 Remove vistigial git-active.py<br/>
OS-1833 panic in fsflush of tmpfs<br/>
OS-1826 tmpfs in a non-global zone does not abide by tmpfs_minfree<br/>
OS-1822 svc.startd dies in getutxent_frec()</p>

<p>illumos-extra<br/>
&#45;------&#45;</p>

<p>OS-1869 upgrade openssl1x to 1.0.1d<br/>
OS-1846 platform node executes proto code during build</p>

<p>kvm<br/>
&#45;------&#45;</p>

<p>kvm-cmd<br/>
&#45;------&#45;</p>

<h2><a name="SmartOSChangeLog-Jan24%2C2013"></a>Jan 24, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;<br/>
OS-1839: Improve imgadm install message<br/>
OS-1831 update platform bunyan to 0.18.1<br/>
OS-1669 make it possible to rotate log for running VM.js process<br/>
Add noinstall grub entry to build_iso<br/>
OS-1824: sysinfo should show server 'setup' state<br/>
OS-1810 configure should not depend on user's PATH<br/>
OS-1771 smartos-live configure fetch_studio error: 'tar: directory checksum error'</p>

<p>illumos<br/>
&#45;------&#45;<br/>
OS-1823 git-pbchk should not depend on mercurial<br/>
OS-1832 fix for OS-1783 broke at when zone has no network<br/>
OS-1783 Cron firing delayed when unable to lookup hostname in getaddrinfo<br/>
OS-1817 yes(1) needs error handling to avoid spinning<br/>
OS-1763 mount of /etc/svc/volatile failed: Device busy<br/>
OS-1819 lofiadm is looking for libz.so directly instead of libz.so.1<br/>
Illumos Sync<br/>
fix manifest (CA cert removal), mr_sas mismerge<br/>
fix mismerge in dmu.c; remove build for pylibbe<br/>
Illumos Sync<br/>
OS-1802 want column(1)<br/>
OS-1811 zfs_write()/zfs_putpage() deadlock<br/>
3451 archive libraries with no symbols shouldn't require a string table<br/>
3450 elfdump crashes on non-Solaris/Linux objects<br/>
3436 relocatable objects also need sloppy relocation<br/>
3439 discarded sections shouldn't end up on output lists<br/>
3453 GNU comdat redirection does exactly the wrong thing<br/>
3442 sgs checks should be run in normal builds<br/>
3441 &#45;zassert-deflib messages are in the wrong place<br/>
3440 librtld_db demos need warnings gagged<br/>
3447 improve the comment in txg.c<br/>
3443 Missing curly-braces in one ixgbe file.<br/>
995 boot message: No randomness provider enabled for /dev/random<br/>
3315 svccfg export &#45;a drops values in PG "general"<br/>
3408 detect socket type of newer AMD CPUs<br/>
3414 Need a new word of AT_SUN_HWCAP bits<br/>
3415 Add isainfo support for f16c and rdrand<br/>
3416 Need disassembler support for rdrand and f16c<br/>
3413 isainfo &#45;v overflows 80 columns<br/>
3417 mdb disassembler confuses rdtscp for invlpg<br/>
1723 apix module mistakingly sets TPR<br/>
3364 dboot should check boot archive integrity<br/>
3396 new psrinfo does not print socket type<br/>
3352 would like 64bit install libraries<br/>
3311 Want a test framework for arbitrary OS unit tests<br/>
3312 Add a testrunner package for OS unit tests<br/>
3313 Add a testrunner package to convert ZFS tests from STF<br/>
3381 webrev: The latest version may be obtained here.<br/>
3359 hostid generation should be more "predictable"<br/>
3385 The cdrw manpage should mention ISO, not High Sierra<br/>
3378 cdrw is unable to write some ISO images<br/>
3397 zdb &lt;pool&gt; &lt;objnum&gt; output is too verbose<br/>
3398 zdb can't dump feature flags zap objects<br/>
3337 x64 link-editor is painfully literal-minded about TLS<br/>
3394 combine /usr/bin/df and /usr/xpg4/bin/df<br/>
3327 Add &#45;m flag to df<br/>
3245 in.ndp daemon should not be session leader<br/>
3254 add support in zfs for aclmode=restricted<br/>
3236 zio nop-write (fix uninitialized variables)<br/>
3236 zio nop-write<br/>
3349 zpool upgrade &#45;V bumps the on disk version number, but leaves the in core version<br/>
3272 findunref should support git<br/>
3308 ipmi.h causes SPARC build noise<br/>
3178 Support for LSI 2208 chipset in mr_sas (fix SPARC build)<br/>
3310 root CA certs should be removed from illumos-gate<br/>
3344 splashimage needs to be updated with "new" logo<br/>
3178 Support for LSI 2208 chipset in mr_sas<br/>
3329 spa_sync() spends 10-20% of its time in spa_free_sync_cb()<br/>
3330 space_seg_t should have its own kmem_cache<br/>
3331 deferred frees should happen after sync_pass 1<br/>
3335 make SYNC_PASS_&#42; constants tunable<br/>
3314 disable multi-threaded dump until it can be removed<br/>
3339 vmware e1000 emulation does not support multiple mac addresses<br/>
OS-1588 library search path very broken in perl build<br/>
OS-1820 update gcc 4.4.4 to include &#45;fstrict-calling-conventions<br/>
OS-1331 libxml2 build system needs conversion<br/>
OS-1332 openssl build system needs conversion<br/>
OS-1775 platform OpenSSL needs upgrade, name mangling<br/>
OS-1814 nss-nspr needs to use the bootstrap compilers<br/>
OS-1816 libidn in illumos-extra must deliver headers to proto</p>

<h2><a name="SmartOSChangeLog-Jan10%2C2013"></a>Jan 10, 2013</h2>

<p>smartos-live<br/>
&#45;------&#45;<br/>
OS-1797 log more process info when a GZ process blocks zone shutdown<br/>
OS-1793 make VM.start return only after VM has gone to running<br/>
OS-1790 fix typo in vmadm's shutdown/reboot message.<br/>
OS-1784 build should use gxgettext from pkgsrc</p>

<p>illumos<br/>
&#45;------&#45;<br/>
OS-1804 agent lwp clobbers amd64 abi stack redzone<br/>
OS-1803 elf and gelf manual pages missing<br/>
OS-1812 ::typedef should be able to source types from other files<br/>
OS-1794 /usr/sbin/shutdown fails to bring down zone<br/>
OS-1795 zone error: failed to setup environment<br/>
OS-1792 dbuf_read_impl shows too much enthusiasm<br/>
OS-1786 /usr/bin/man should not override PATH if TROFF is set<br/>
OS-1788 need manual page for htonll and ntohll<br/>
OS-1787 missing man 3xnet manual pages<br/>
OS-1785 cmd/ssh/Makefile shouldn't hardcode paths<br/>
OS-1782 want ::x86_featureset</p>

<p>kvm-cmd<br/>
&#45;------&#45;<br/>
HVM-763 uhci timer does not properly set expire time<br/>
HVM-765 qemu needs &#45;msave-args<br/>
HVM-767 qemu e1000g shouldn't botch popts<br/>
HVM-768 qemu dcmds for ram and bios</p>

<h2><a name="SmartOSChangeLog-Dec27%2C2012"></a>Dec 27, 2012</h2>

<p>smartos-live<br/>
&#45;------&#45;<br/>
STOR-109 want RAIDZ2 bias for large-slow-disk configurations<br/>
joyent/smartos-live#140 fix zpool names in brand scripts<br/>
OS-1769 require nic_tag on all NICs when adding<br/>
OS-1660 / joyent/smartos-live#138 require non-dhcp NICs netmask, and require model for KVM nics<br/>
OS-1768 prevent failures when zone moves /var/svc/provisioning before fs.watch is setup.<br/>
OS-1765 fix mechanism for finding quota when metadata unavailable and no delegated dataset.<br/>
OS-1767: Fix exception handling on zone socket error<br/>
OS-1751 mkzpool should accept &#45;f</p>

<p>illumos<br/>
&#45;------&#45;<br/>
OS-1779 svccfg export should accept instance FMRIs<br/>
OS-1566 filesystem limits for ZFS datasets<br/>
OS-1780 ipdadm accidentally a newline<br/>
3315 svccfg export &#45;a drops values in PG "general"</p>

<h2><a name="SmartOSChangeLog-Dec13%2C2012"></a>Dec 13, 2012</h2>

<p>smartos-live<br/>
&#45;------&#45;<br/>
OS-1759 mkdir /var/log/vm if it doesn't exist and if we can't create it, just log to ring buffer.<br/>
OS-1755 add test case for non-vmadm snapshots to ensure this is exercised in the future.<br/>
HEAD-1352 platform image larger than necessary<br/>
OS-1755 fix typo which breaks things when you have snapshots created outside vmadm.<br/>
OS-1753 / joyent/smartos-live#147 fixed update to nics.*.model<br/>
OS-1672 add support for 'SDC Agents' in the sysinfo output.<br/>
OS-1752 / joyent/smartos-live#144 fixed regression with setting vnc_port=-1<br/>
OS-1709 add support for creating, deleting and rolling-back snapshots on OS VMs which have no extra datasets.<br/>
OS-1746,OS-1739 cleanup some issues with provisioning transitions<br/>
OS-1746 have vmadmd and vmadm both watching for provisioning &#45;&gt; running transitions<br/>
OS-1739 remove support for ancient datasets and the joyent brand since they refuse to run mdata:exec<br/>
OS-1744 add support for zonecfg flags added by OS-1170 to VM.js<br/>
1742 make vmobj.resolvers flattenable<br/>
OS-1740 vmadm sometimes fails to write log records before exit<br/>
FWAPI-7 fwadm should refuse to run in a non-global zone<br/>
OS-1734 'zonemon &#45;k' broken with mdb errors and other errors coming from background<br/>
OS-1597 don't allow &#45;o nics.*.ip or other wildcard values for ordering or sorting.<br/>
OS-1737 add workaround for provisioning smartos-1.8.0 and smartos-1.8.1 datasets (also see joyent/smartos-live#148)<br/>
OS-1736 Allow creating / modifying firewall rules in the GZ (manifest update)<br/>
OS-1736 Allow creating / modifying firewall rules in the GZ<br/>
OS-1703 mdata-get should write errors and diagnostics to stderr.<br/>
OS-1726 add support to VM.js and vmadm for 'sngl' brand.<br/>
OS-1735 add support to metadata agent for sngl brand.<br/>
OS-1731 fix problem where vmadmd doesn't bring up VNC on provisioning-&gt;running transition.<br/>
OS-1732 don't assume vmobj.zpool is set and use vmobj.zonepath instead when available.<br/>
OS-1027 add 'provisioning' state for VMs when they're created until they're actually 'running'.<br/>
illumos<br/>
&#45;------&#45;<br/>
OS-1760 Need disassembler support for rdrand and f16c<br/>
OS-1757 Add isainfo support for f16c and rdrand (fix xset flags)<br/>
OS-1758 Need a new word of AT_SUN_HWCAP bits<br/>
OS-1757 Add isainfo support for f16c and rdrand<br/>
OS-1756 task_join()/pr_lookup_procdir()/pr_szoneid() deadlock<br/>
OS-1749 oawk must die<br/>
OS-1705 smf won't transition down<br/>
OS-1734 'zonemon &#45;k' broken with mdb errors and other errors coming from background<br/>
OS-1728 add force unmount support to tmpfs</p>

<h2><a name="SmartOSChangeLog-Nov30%2C2012"></a>Nov 30, 2012</h2>

<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;---------------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1731 fix problem where vmadmd doesn't bring up VNC on provisioning-&gt;running transition.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1732 don't assume vmobj.zpool is set and use vmobj.zonepath instead when available.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1027 add 'provisioning' state for VMs when they're created until they're actually 'running'.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1729 configure does not handle comments in configure-branches</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1717 bump mdata:execute timeout to 300s from 60s</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1714 update to json 5.1.1 for jsontool#42 fix</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1710 add missing manifest entry for mdata-execute script.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1710 Expand mdata:execute to handle the /var/svc/provisioning flag file. Make sure the mdata.xml file is added to the 'joyent' brand too (just disabled, to be enabled by zoneinit).</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1671 add support for /.smartdc_version file which will indicate the SDC branch we're runnign under.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1685 dboot should check boot archive integrity</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1627 smartos-live ./configure needs some love</font></p>

<p><font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;-----------------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1723 DTrace should speak JSON</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1704 add a time field with ISO time or unix timestamp to zoneevent output</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-777 ipfilter should support loading / modifying per-zone rules from the GZ</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1725 add SNGL brand</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1713 lscf_instance_verify does not properly handle disabled EMI</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1724 umem walker can fail on ptc-enabled caches</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1474 Want ::typedef</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1598 Want mdb &#45;e</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1600 Want an mdb test suite driver</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1632 mdb on x86 should be able to print alternate register names</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1699 libctf should support removing a dynamic type</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1700 libctf does not validate arrays correctly</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1701 libctf does not validate function types correctly</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1685 dboot should check boot archive integrity</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1693 need workaround for RICHMOND-16</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1706 zfs compression in a zone is ok after all</font></p>


<p><font color="#222222">kvm</font><br/>
<font color="#222222">&#45;----&#45;</font><br/>
<font color="#222222">&nbsp; HVM-761 host panic in paging64_walk_addr+0xc6</font></p>

<p><font color="#222222">kvm-cmd</font><br/>
<font color="#222222">&#45;----------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; HVM-758 Add a qmp entry for hw setup complete</font></p>


<h2><a name="SmartOSChangeLog-Nov15%2C2012"></a>Nov 15, 2012</h2>

<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;---------------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1628 tools/build_illumos should not pass &#45;i</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1695 fix IP address of&nbsp;</font><a href="http://datasets.joyent.com/">datasets.joyent.com</a><font color="#222222">&nbsp;now that old one was deleted.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-717 apix code induces hangs</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1684 fix vmadm display of delegated dataset when mountpoint has been changed</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1633 add support for 'snapshots' listing in VM objects in VM.js</font><br/>
<font color="#222222">&nbsp; &nbsp; smartos-live#133 fixed issue deleting KVM VMs with snapshots (thanks calmh)</font><br/>
<font color="#222222">&nbsp; &nbsp; smartos-live#114 imgadm should send Host header in HTTP requests</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1441 routing-setup service provides no useful log output</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1680 update node-dtrace provider to 3336f6ebd2fc73c6cfd4d09be3d80a</font><font color="#222222">5716aace8d (0.2.3)</font></p>

<p><font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;------------------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1697 zoneadmd halt retry timeout should be increased</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1694 exit()/lxprocfs races can induce panic</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1698 Missing pcbe modules for Sandy and Ivy Bridge families</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-717 apix code induces hangs</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-577 race in netstack_unregister and zone creation</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1690 want zid2zone and zdid2zone</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1691 want a dcmd for going from netstack id to nestack_t</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1683 ship elfedit</font><br/>
<font color="#222222">&nbsp; &nbsp; 3203 system-zones tries to deliver global-zone only template files into NGZ</font><br/>
<font color="#222222">&nbsp; &nbsp; 3294 pfiles postmortem support</font><br/>
<font color="#222222">&nbsp; &nbsp; 3298 illumos link-editor and related tools should be differentiable</font><br/>
<font color="#222222">&nbsp; &nbsp; 3263 link.h should work in a largefile environment</font><br/>
<font color="#222222">&nbsp; &nbsp; 3265 link-editor builds bogus .eh_frame_hdr on ia32</font><br/>
<font color="#222222">&nbsp; &nbsp; 3306 zdb should be able to issue reads in parallel</font><br/>
<font color="#222222">&nbsp; &nbsp; 3321 'zpool reopen' command should be documented in the man page and help message</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1682 lxpr_uiobuf_write() can overflow its buffer</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1441 routing-setup service provides no useful log output</font><br/>
<font color="#222222">&nbsp; &nbsp; 3304 need workaround for QEMU bug that induces bad e1000g checksums</font><br/>
<font color="#222222">&nbsp; &nbsp; 3246 ZFS I/O deadman thread</font><br/>
<font color="#222222">&nbsp; &nbsp; 3302 ld(1) should document &#45;zguidance</font><br/>
<font color="#222222">&nbsp; &nbsp; 3299 file should only care about object capabilities</font><br/>
<font color="#222222">&nbsp; &nbsp; 3300 file should care about all object capabilities</font><br/>
<font color="#222222">&nbsp; &nbsp; 3301 lapsus calami multum</font><br/>
<font color="#222222">&nbsp; &nbsp; 3285 memory leaks in libsldap</font><br/>
<font color="#222222">&nbsp; &nbsp; 3169 userland amd64 code should save arguments</font><br/>
<font color="#222222">&nbsp; &nbsp; 3180 mdb should handle push-based argument save area</font><br/>
<font color="#222222">&nbsp; &nbsp; 3192 mdb save-args matching should accept more agressive insn scheduling</font><br/>
<font color="#222222">&nbsp; &nbsp; 3193 mdb save-args matching should only consider insns which have executed</font><br/>
<font color="#222222">&nbsp; &nbsp; 3288 git-pbchk invents blank lines, then complains about them</font><br/>
<font color="#222222">&nbsp; &nbsp; 702 tput calls gets()</font><br/>
<font color="#222222">&nbsp; &nbsp; 3286 README.mapfiles needs an update</font><br/>
<font color="#222222">&nbsp; &nbsp; 2563 remove python2.4 from onbld</font><br/>
<font color="#222222">&nbsp; &nbsp; 1147 integrate the virtio-block driver</font><br/>
<font color="#222222">&nbsp; &nbsp; 1562 Integrate the virtio core module</font><br/>
<font color="#222222">&nbsp; &nbsp; 2911 blkdev-related panic on DEBUG kernels</font><br/>
<font color="#222222">&nbsp; &nbsp; 3261 linker should ignore unknown hardware capabilities</font><br/>
<font color="#222222">&nbsp; &nbsp; 3259 ld.so.1(1) should document capabilities environment variables</font><br/>
<font color="#222222">&nbsp; &nbsp; 3260 linker is insufficiently careful with strtok</font><br/>
<font color="#222222">&nbsp; &nbsp; 72 &#95;tx_error needs to preserve the errno value it is supposed to display</font><br/>
<font color="#222222">&nbsp; &nbsp; 3177 LDAP client: support for uniqueMember attribute</font><br/>
<font color="#222222">&nbsp; &nbsp; 3262 webrev only includes oldest cset comment when file changes multiple times</font><br/>
<font color="#222222">&nbsp; &nbsp; 3270 Additional PCI ID (1000,86) needed for mpt_sas(7d)</font><br/>
<font color="#222222">&nbsp; &nbsp; 3258 ztest's use of file descriptors is unstable</font><br/>
<font color="#222222">&nbsp; &nbsp; 370 would like an open ipmi baseboard driver</font><br/>
<font color="#222222">&nbsp; &nbsp; 3206 Long(er) username crontab setup failure</font><br/>
<font color="#222222">&nbsp; &nbsp; 3150 poll times out immediately in 32bit kernels</font><br/>
<font color="#222222">&nbsp; &nbsp; 3217 cfgadm should spell "adapters" correctly</font><br/>
<font color="#222222">&nbsp; &nbsp; 3154 Nonconforming tolower and toupper with UTF-8 locales</font><br/>
<font color="#222222">&nbsp; &nbsp; 2064 vnic sets up protection before upper mac leading to panic</font><br/>
<font color="#222222">&nbsp; &nbsp; 3234 docbook xsl path should be configurable</font><br/>
<font color="#222222">&nbsp; &nbsp; 3228 Want &#45;zassert-deflib for ld</font><br/>
<font color="#222222">&nbsp; &nbsp; 3229 ld(1) does not document &#45;zfatal-warnings</font><br/>
<font color="#222222">&nbsp; &nbsp; 3230 ld.so.1 should check default paths for DT_DEPAUDIT</font><br/>
<font color="#222222">&nbsp; &nbsp; 3145 single-copy arc</font><br/>
<font color="#222222">&nbsp; &nbsp; 3212 ztest: race condition between vdev_online() and spa_vdev_remove()</font><br/>
<font color="#222222">&nbsp; &nbsp; 1930 smb_match functions incorrectly handle multibyte characters</font><br/>
<font color="#222222">&nbsp; &nbsp; 1931 smb_convert_wildcards incorrectly expands &lt; at the end of the pattern</font><br/>
<font color="#222222">&nbsp; &nbsp; backout 3157: needs more work</font><br/>
<font color="#222222">&nbsp; &nbsp; 3200 panic from ill_taskq_dispatch</font><br/>
<font color="#222222">&nbsp; &nbsp; 3027 installgrub can segfault when encountering bogus data on disk</font><br/>
<font color="#222222">&nbsp; &nbsp; 3208 moving zpool cross-endian results in incorrect user/group accounting</font><br/>
<font color="#222222">&nbsp; &nbsp; 2933 compiler warning gags need better granularity</font><br/>
<font color="#222222">&nbsp; &nbsp; 3132 remove support for building with gcc 3</font><br/>
<font color="#222222">&nbsp; &nbsp; 1126 date(1)'s usage message doesn't mention &#45;R</font><br/>
<font color="#222222">&nbsp; &nbsp; 1788 "WARNING: Cannot lookup root device: /devices" is useless when rootfs is zfs</font><br/>
<font color="#222222">&nbsp; &nbsp; 1828 powerd's "Able to open /dev/srn" notice is useless</font><br/>
<font color="#222222">&nbsp; &nbsp; 2547 Minor updates to README</font><br/>
<font color="#222222">&nbsp; &nbsp; 2678 zfs manpage mis-identifies checksum default value</font><br/>
<font color="#222222">&nbsp; &nbsp; 2811 missing implementation: zfs send &#45;r</font><br/>
<font color="#222222">&nbsp; &nbsp; 3199 Update copyright years in usr/src/prototypes/</font><br/>
<font color="#222222">&nbsp; &nbsp; 3214 ldapclient man page does not document tls:none setting</font><br/>
<font color="#222222">&nbsp; &nbsp; 3210 ld should tolerate SHT_PROGBITS for .eh_frame sections on amd64</font><br/>
<font color="#222222">&nbsp; &nbsp; 3162 nfs: some unusable code in nfs4_srv.c</font><br/>
<font color="#222222">&nbsp; &nbsp; 3160 nfs: OPEN_CONFIRM with non-regular file returns wrong error</font><br/>
<font color="#222222">&nbsp; &nbsp; 3161 nfs: OPEN_DOWNGRADE with non-regular file returns wrong error</font><br/>
<font color="#222222">&nbsp; &nbsp; 3158 nfs: Server should return NFS4_OK with zero length COMPOUND request</font><br/>
<font color="#222222">&nbsp; &nbsp; 3159 nfs: Server returns wrong access_mode with some ACCESS requests</font><br/>
<font color="#222222">&nbsp; &nbsp; 3157 nfs: wrong utf8-encoded string should be cause of error</font><br/>
<font color="#222222">&nbsp; &nbsp; 3156 nfs: '.', '..', and filename with '/' return wrong error code</font><br/>
<font color="#222222">&nbsp; &nbsp; 3155 nfs: fs_location being asked but not setted return error</font><br/>
<font color="#222222">&nbsp; &nbsp; 3149 ps should have dmodel as an output format</font><br/>
<font color="#222222">&nbsp; &nbsp; 3139 zdb dies when it tries to determine path of unlinked file</font><br/>
<font color="#222222">&nbsp; &nbsp; 3202 prevent compiler function cloning</font><br/>
<font color="#222222">&nbsp; &nbsp; 3189 kernel panic in ZFS test suite during hotspare_onoffline_004_neg</font><br/>
<font color="#222222">&nbsp; &nbsp; 3047 grep support for &#45;r would be useful</font><br/>
<font color="#222222">&nbsp; &nbsp; 3052 uname compatibility should be implemented with redefine_extname</font><br/>
<font color="#222222">&nbsp; &nbsp; 2224 closed-bins should be stripped of CTF</font><br/>
<font color="#222222">&nbsp; &nbsp; 2986 nfs: exi refcounter leak at rfs3_lookup</font><br/>
<font color="#222222">&nbsp; &nbsp; 3181 t_onfault should be preserved across pagefaults</font><br/>
<font color="#222222">&nbsp; &nbsp; 3179 vmem_xalloc needs to check for overflow</font><br/>
<font color="#222222">&nbsp; &nbsp; 3064 usr/src/cmd/zpool/zpool_main.c misspells "successful"</font><br/>
<font color="#222222">&nbsp; &nbsp; 3067 Typo in spelling "succssful"</font></p>

<p><font color="#222222">illumos-extra</font><br/>
<font color="#222222">&#45;---------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1673 gmake clean misses some 64-bit strap directories</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1681 upgrade platform node to 0.8.14</font></p>


<h2><a name="SmartOSChangeLog-Nov1%2C2012"></a>Nov 1, 2012</h2>

<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;---------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1677 Add Makefile sections for node-dtrace module.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1677 Add unmodified node-dtrace provider (0.2.2) db13b0aeafc1db58c756ee4d9ed65b</font><font color="#222222">808a6b700c and libusdt 8ab25b6e5d32afc9147890ba80b1e9</font><font color="#222222">9a4102717e</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1676: 'json &#45;h' output has incorrect link to online man page</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1615 switch VM.js logging to bunyan</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1614 pull in node-bunyan 0.14.6 which has some changes I made/need.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1654 0-livesrc-stamp should build with &#45;zassert-deflib</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1653 smartos-live needs to help strap along</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1549 fix so vmadm stop; vmadm start works, add tests.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1649 fix handling of quota when sysinfo unavailable.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1644 Update bge pci ids for OS-1366</font><br/>
<font color="#222222">&nbsp; &nbsp; TOOLS-207: Fix overzealous escaping</font><br/>
<font color="#222222">&nbsp; &nbsp; TOOLS-207: Do not drop backslashes when returning metadata values that contains them</font></p>


<p><font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;------------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1645 after svccfg import is killed, subsequent import fails</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1665 Update pci.ids to latest release</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1634 svcs &#45;ZL does not work when a pattern is specified</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1366 add support for BCM 5719, 5720, and BCM5784M chipset</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1643 improve comments for svc.startd [fix unicode backtick]</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1643 improve comments for svc.startd</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1209 shutdown of a zone can silently fail &#42;sometimes&#42; when a zone is still starting up</font><br/>
<font color="#222222">&nbsp; &nbsp; 2869 duplicate packets with vnics over aggrs</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1626 tar &#45;C support on extract would be nice</font></p>

<p><font color="#222222">illumos-extra</font><br/>
<font color="#222222">&#45;-----------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1639 illumos-extra should build with &#45;zassert-deflib</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1640 illumos-extra is missing some dependencies</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1641 1-extra-stamp build erroneously uses bootstrap build</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1652 ntp is missing dependency on routing</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1126 NTP Service Can Stall "Setup Reboot" by 30 Minutes</font></p>

<p><font color="#222222">kvm-cmd</font><br/>
<font color="#222222">&#45;-----&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1658 kvm-cmd should build with &#45;zassert-deflib</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1655 kvm user portions should build with &#45;zassert-deflib and &#45;zguidance</font></p>


<h2><a name="SmartOSChangeLog-Oct18%2C2012"></a>Oct 18, 2012</h2>

<p>smartos-live<br/>
&#45;----------&#45;<br/>
OS-1492 SmartOS and SDC should have the same net-physical<br/>
OS-1623 Increase process.max-file-descriptor rctl default value<br/>
OS-1625 vmadm: improve random MAC generation and related logging<br/>
OS-1624: json 5.1.0<br/>
OS-1615 switch to bunyan be4909a0ac93e1cf2103386e1147e05c8733c777 (0.14.5)<br/>
OS-1615 import node-bunyan 1844dfd0625689774ffd1a6f65d134381a209493<br/>
OS-1610 fix the timing issue wrt sysinfo by reloading just after mdata is available<br/>
OS-1611 fix alias column width for long aliases.<br/>
OS-1610 fix output of sysinfo within zones.<br/>
OS-1565 Allow provisioning VMs on aggregations (allow denormalized MACs)<br/>
OS-1565 Allow provisioning VMs on aggregations<br/>
OS-1493 configure should work as non-root user<br/>
OS-1592 Hasta la vista libshell docs<br/>
OS-1594 FLEX path should be explicitly set<br/>
AGENT-519: Support the listing of keys via the KEYS command</p>

<p>illumos-joyent<br/>
&#45;------------&#45;<br/>
OS-1561 mdb_v8 should display JSDate objects<br/>
OS-1562 mdb_v8 should differentiate objects based on constructor<br/>
OS-1563 mdb_v8 generates spurious warnings on some fields<br/>
OS-1564 ::findjsobjects can avoid many one-byte mdb_vread()'s<br/>
OS-1601 mdb_v8 should be able to print objects with dictionary properties<br/>
OS-1618 mdb_v8 should quote strings when printing JSON objects<br/>
OS-1617 mdb_printf()'s "%H" misprints integer values larger than 64K<br/>
OS-1607 FSS observability needs to handle projects with no shares<br/>
OS-1605 vrrpadm dies when its configuration file doesn't exist<br/>
OS-1603 fixed issue with hard links for locale files where there shouldn't be<br/>
OS-1595 locale support missing<br/>
OS-1590 zfs dedup &amp; compression properties should not be changeable on a delegated dataset<br/>
OS-1592 Hasta la vista libshell docs<br/>
OS-1593 aw hacks no longer needed</p>

<p>illumos-extra<br/>
&#45;-----------&#45;<br/>
OS-1630 screen needs to explicitly state its prefix<br/>
OS-1631 system screenrc should be in /etc not /usr<br/>
OS-1621 Update OpenSSL to latest stable (CVE-2012-2333)<br/>
OS-1596 ntp doesn't set path in it's custom install targets</p>

<h2><a name="SmartOSChangeLog-Oct4%2C2012"></a>Oct 4, 2012</h2>

<p>smartos-live<br/>
&#45;----------&#45;<br/>
OS-1586 Lockfile naming doesn't allow for concurrent builds<br/>
OS-1585 SmartOS build should use docbook from pkgsrc<br/>
OS-1581 mpt_sas missing alias for pciex1000,87<br/>
OS-1577 configure should set JAVA_HOME<br/>
OS-1578 configure should set GNU ROOT<br/>
OS-1489 vmadm: support VRRP vnics (man page update)<br/>
OS-1093 Need X540 driver aliases support<br/>
OS-1560 Add Atheros AR8132 / L1c PCI IDs<br/>
STOR-102 zfs cache flush and other settings are misbound<br/>
OS-1489 vmadm: support VRRP vnics</p>

<p>illumos<br/>
&#45;-----&#45;<br/>
OS-1589 Stop building hal<br/>
OS-883 Panic in i_mac_notify<br/>
OS-1568 Want &#45;zassert-deflib for ld<br/>
OS-1569 ld.so.1 should check default paths for DT_DEPAUDIT<br/>
OS-1570 ld(1) does not document &#45;zfatal-warnings<br/>
OS-1584 ON should support a path to docbook XSL Root<br/>
OS-1576 Sundry uninitialised variables<br/>
OS-1575 sas for the goose<br/>
OS-1574 libzdoor checks for NULL that cannot be<br/>
OS-1573 vnic_dev.c insufficiently explicit<br/>
OS-1572 Explicitly handle all possible enum values in switches<br/>
OS-1571 Placate gcc &#45;Wparentheses<br/>
OS-1583 ship msg tools in ast for fake-subset<br/>
OS-1582 ship fp driver<br/>
OS-1506 panic from ill_taskq_dispatch<br/>
3320 noncompliant devices break sd-config-list (uninit variable)<br/>
OS-1558 Updated mr_sas breaks Studio build<br/>
3220 noncompliant devices break sd-config-list</p>

<p>illumos-extra<br/>
&#45;-----------&#45;<br/>
OS-1587 gcc and gas makefile rules not properly updated<br/>
OS-1580 binutils tools should have g prefix<br/>
OS-1579 binutils needs to use bash as the shell<br/>
illumos-extra#7 pbzip2 filesize limited to 2GB</p>

<p>kvm<br/>
&#8212;<br/>
HVM-745 Reintroduce kvm_para.h<br/>
HVM-738 smb_wmb and smb_rmb in kvm_x86.h shouldn't be visible to userland</p>

<p>kvm-cmd<br/>
&#45;-----&#45;<br/>
HVM-750 guest virtio drivers are racy with respect to interrupts<br/>
HVM-751 CONFIGURE_ONLY check in build.sh is wrong<br/>
HVM-752 Import qemu-kvm.git barrier changes</p>


<h2><a name="SmartOSChangeLog-Sept24%2C2012"></a>Sept 24, 2012</h2>

<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;----------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-534 Replace /etc/services with an updated list</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1143 Update mr_sas for LSI 2208 support</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1550 FSS observability and comment improvements</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1477 update /usr/bin/json to v5.0.0</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1546 add &#45;a option to zonememstat to add alias column in output.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1543 core cleanup in cron erroneously looks at cores/&#42; (which might not exist) rather than cores/</font><br/>
<font color="#222222">&nbsp; &nbsp; TOOLS-184 fix intermittent net failures in VM test suite (skip these tests for now)</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1324 illumos should be built with the illumos-extra gcc 4.4.4</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1526 move binutils into illumos-extra</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1539 core pruning can result in email warnings</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1538 presence of /etc/zones/global.xml causes problems</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1536 fix race in VM creation when other VMs partially deleted.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1512 improved FSS observability</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1521 Add image_uuid to list of &#45;o/-s fields in vmadm</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1529 Hi, everybody&#33; I'm dr_sas.</font><br/>
<font color="#222222">&nbsp; &nbsp; HEAD-1245 disable console-login:ttyb when running in a VM.</font></p>

<p><font color="#222222">illumos</font><br/>
<font color="#222222">&#45;-----&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1551 ld should tolerate SHT_PROGBITS for .eh_frame sections on amd64</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1552 dr_sas needs fixes from OS-709</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1466 Ship ldap clients service for GZ and joyent brand</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1234 add new rctls to resource_controls(5) man page</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1553 duplicate code in cpu_update_pct</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1143 Update mr_sas for LSI 2208 support</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1550 FSS observability and comment improvements</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1545 dtrace_dof_maxsize is far too small</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1542 libipd needs some manifest additions</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1282 SunSSH config should have TCPKeepAlive as synonym for KeepAlive</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1524 t_onfault should be preserved across pagefault() in trap()</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1541 vmem_xalloc() needs to check for overflow</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1540 Would like %N support in date(1)</font><br/>
<font color="#222222">&nbsp; &nbsp; illumos sync</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1530 ipmi should use /dev/ipmi0 for compatability</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1531 allow get_smbios_info to fail</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1532 remove bmc_intf.h</font><br/>
<font color="#222222">&nbsp; &nbsp; 3098 zfs userspace/groupspace fail without saying why when run as non-root</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1529 Hi, everybody&#33; I'm dr_sas.</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1512 improved FSS observability</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1514 ipmi assumes FreeBSD copyin() behaviour</font><br/>
<font color="#222222">&nbsp; &nbsp; 3146 i915 debugging code can chew SSE state</font><br/>
<font color="#222222">&nbsp; &nbsp; 3165 Privilege.xs perform unsafe casting of priv_ptype_t to int</font><br/>
<font color="#222222">&nbsp; &nbsp;Backed out changeset e05f5705283d &nbsp;(wrong name)</font><br/>
<font color="#222222">&nbsp; &nbsp; 3165 Privilege.xs perform unsafe casting of priv_ptype_t to int</font><br/>
<font color="#222222">&nbsp; &nbsp; 3006 VERIFY[S,U,P] and ASSERT[S,U,P] frequently check if first argument is zero</font><br/>
<font color="#222222">&nbsp; &nbsp; 3021 option for time-ordered output from dtrace(1M) (fix lint)</font><br/>
<font color="#222222">&nbsp; &nbsp; 1884 Empty "used" field for zfs &#42;space commands</font><br/>
<font color="#222222">&nbsp; &nbsp; 3028 zfs</font> </p>
<div class="error"><span class="error">Unknown macro: {group,user}</span> </div>
<p><font color="#222222">space &#45;n prints (null) instead of numeric GID/UID</font><br/>
<font color="#222222">&nbsp; &nbsp; 3048 zfs</font> </p>
<div class="error"><span class="error">Unknown macro: {user,group}</span> <p><font color="#222222">space [-s&#124;-S] is broken</font><br/>
<font color="#222222">&nbsp; &nbsp; 3049 zfs</font> </p></div>
<p><font color="#222222">space &#45;t doesn't really filter the results</font><br/>
<font color="#222222">&nbsp; &nbsp; 3060 zfs</font> </p>
<div class="error"><span class="error">Unknown macro: {user,group}</span> <p><font color="#222222">space &#45;H output isn't tab-delimited</font><br/>
<font color="#222222">&nbsp; &nbsp; 3061 zfs</font> </p></div>
<p><font color="#222222">space &#45;o doesn't use specified fields order</font><br/>
<font color="#222222">&nbsp; &nbsp; 3093 zfs</font> </p>
<div class="error"><span class="error">Unknown macro: {user,group}</span> </div>
<p><font color="#222222">space's &#45;i is noop</font><br/>
<font color="#222222">&nbsp; &nbsp; 3140 fmdump &#45;t/-T incorrectly parses date/time</font><br/>
<font color="#222222">&nbsp; &nbsp; 3128 igb missing I350 SERDES cases</font><br/>
<font color="#222222">&nbsp; &nbsp; 3135 lofi_uncompress doesn't initialize all variables</font><br/>
<font color="#222222">&nbsp; &nbsp; 3133 nfs4: remove static for nfs4_max_xxx</font><br/>
<font color="#222222">&nbsp; &nbsp; 3109 libshare_nfs: findopt() should return index</font><br/>
<font color="#222222">&nbsp; &nbsp; 3106 rpc: xdr_sizeof can return wrong size</font><br/>
<font color="#222222">&nbsp; &nbsp; 3134 nfs4: cleaning code in nfs4_xdr</font><br/>
<font color="#222222">&nbsp; &nbsp; 3107 nfs4_getattr incorrectly checks bit masks</font><br/>
<font color="#222222">&nbsp; &nbsp; 3129 'zpool reopen' restarts resilvers</font><br/>
<font color="#222222">&nbsp; &nbsp; 3130 ztest failure: Assertion failed: 0 == dmu_objset_destroy(name, B_FALSE) (0x0 == 0x10)</font><br/>
<font color="#222222">&nbsp; &nbsp; 3138 smb_token_create_privs() passes const char to smb_lgrp_getbyname()</font><br/>
<font color="#222222">&nbsp; &nbsp; 3122 zfs destroy filesystem should prefetch blocks</font><br/>
<font color="#222222">&nbsp; &nbsp; 3121 missing SMF method directories should say something useful</font><br/>
<font color="#222222">&nbsp; &nbsp; 3112 ztest does not honor ZFS_DEBUG</font><br/>
<font color="#222222">&nbsp; &nbsp; 3113 ztest should use watchpoints to protect frozen arc bufs</font><br/>
<font color="#222222">&nbsp; &nbsp; 3114 some leaked nvlists in zfsdev_ioctl</font><br/>
<font color="#222222">&nbsp; &nbsp; 3115 poll(2) returns prematurely in presence of spurious wakeups</font><br/>
<font color="#222222">&nbsp; &nbsp; 1862 incremental zfs receive fails for sparse file &nbsp;&gt; 8PB</font><br/>
<font color="#222222">&nbsp; &nbsp; 3123 need a way to force loading of DTrace helpers</font><br/>
<font color="#222222">&nbsp; &nbsp; 2982 nfs3: cleanup debug code at nfs3_srv.c</font><br/>
<font color="#222222">&nbsp; &nbsp; 3119 zonecfg(1M) still mentions sparse zones</font><br/>
<font color="#222222">&nbsp; &nbsp; 3117 aac forgets C isn't math</font><br/>
<font color="#222222">&nbsp; &nbsp; 2904 hxge forgets C isn't math</font><br/>
<font color="#222222">&nbsp; &nbsp; 2601 kctl_isadep.c should support four serial consoles</font><br/>
<font color="#222222">&nbsp; &nbsp; 3104 eliminate empty bpobjs</font><br/>
<font color="#222222">&nbsp; &nbsp; 3120 zinject hangs in zfsdev_ioctl() due to uninitialized zc</font><br/>
<font color="#222222">&nbsp; &nbsp; 3100 zvol rename fails with EBUSY when dirty</font><br/>
<font color="#222222">&nbsp; &nbsp; 3103 zfs mdb module may get wrong refcount struct</font><br/>
<font color="#222222">&nbsp; &nbsp; 3063 many instances of unlike enum comparison</font><br/>
<font color="#222222">&nbsp; &nbsp; 3088 some THIRDPARTYLICENSE files erroneously removed</font><br/>
<font color="#222222">&nbsp; &nbsp; 3090 vdev_reopen() during reguid causes vdev to be treated as corrupt</font><br/>
<font color="#222222">&nbsp; &nbsp; 3102 vdev_uberblock_load() and vdev_validate() may read the wrong label</font><br/>
<font color="#222222">&nbsp; &nbsp; 3086 unnecessarily setting DS_FLAG_INCONSISTENT on async destroyed datasets</font><br/>
<font color="#222222">&nbsp; &nbsp; 3057 Remove sgml util from cmd/man</font><br/>
<font color="#222222">&nbsp; &nbsp; 3065 some functions in the tcp module can be static</font><br/>
<font color="#222222">&nbsp; &nbsp; 2399 zfs manual page does not document use of "zfs diff"</font><br/>
<font color="#222222">&nbsp; &nbsp; 3085 zfs diff panics, then panics in a loop on booting</font><br/>
<font color="#222222">&nbsp; &nbsp; 3080 uninitialized var in dcopy_free may panic on boot</font><br/>
<font color="#222222">&nbsp; &nbsp; 3059 cmd/tcpd/&#42; files should have correct functions prototypes</font><br/>
<font color="#222222">&nbsp; &nbsp; 3013 ifconfig with no args should list all interfaces</font><br/>
<font color="#222222">&nbsp; &nbsp; 212 Atheros AR8132 / L1c Gigabit Ethernet Adapter</font><br/>
<font color="#222222">&nbsp; &nbsp; 1154 cpio needs a quiet option</font><br/>
<font color="#222222">&nbsp; &nbsp; 2560 ACPI parser fails to identify COM3 on Tyan motherboard</font><br/>
<font color="#222222">&nbsp; &nbsp; backout 3006: causes 3046 (panics after mounting root)</font><br/>
<font color="#222222">&nbsp; &nbsp; 3006 VERIFY[S,U,P] and ASSERT[S,U,P] frequently check if first argument is zero</font><br/>
<font color="#222222">&nbsp; &nbsp; 3014 Intel X540 Support (fix SPARC build)</font><br/>
<font color="#222222">&nbsp; &nbsp; 3014 Intel X540 Support (fix lint)</font><br/>
<font color="#222222">&nbsp; &nbsp; 3014 Intel X540 Support</font></p>

<p><font color="#222222">illumos-extra</font><br/>
<font color="#222222">&#45;-----------&#45;</font></p>

<p><font color="#222222">&nbsp; &nbsp; OS-1548 upgrade node.js to 0.8.9</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1527 enable extra password options in ipmitool build</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1324 illumos should be built with the illumos-extra gcc 4.4.4</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1526 move binutils into illumos-extra</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1537 platform openssl should have aesni support</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1533 Update ipmitool for new ipmi interface</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1534 /usr/lib/cpp needs to behave in a pre-ansi manner</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1525 upgrade curl to 7.27 (missing file)</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1525 upgrade curl to 7.27</font></p>


<h2><a name="SmartOSChangeLog-Sept6%2C2012"></a>Sept 6, 2012</h2>

<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;--------------&#45;</font><br/>
<font color="#222222">OS-1518 Add I350 Serdes Driver alias</font><br/>
<font color="#222222">OS-1509 fs-usr method should only skip smf repository backup in GZ</font><br/>
<font color="#222222">OS-1503 we need to periodically prune the zone's core dataset for old core dumps</font><br/>
<font color="#222222">OS-1504 In 7.0, the cores dataset quota is a no-op</font><br/>
<font color="#222222">TOOLS-181: Fix javascriptlint build</font><br/>
<font color="#222222">OS-1499 GZ should have more than 1 share</font><br/>
<font color="#222222">OS-1505 In JPC over 100 zones are missing the cores dataset</font><br/>
<font color="#222222">smartos-live#112 fix creation of KVM VMs with preset UUID in payload (make check clean)</font><br/>
<font color="#222222">smartos-live#112 fix creation of KVM VMs with preset UUID in payload.</font><br/>
<font color="#222222">OS-1495 fix incorrect error message when out of memory.</font><br/>
<font color="#222222">smartos-live#94 zone brands need to be more resiliant to missing nic tags</font></p>

<p><font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;-----------------&#45;</font><br/>
<font color="#222222">OS-1501 mdb_v8 doesn't work on v8 3.13.2 and later</font><br/>
<font color="#222222">OS-1519 prstat &#45;n option should accept 0 reviewed by Robert Mustacchi</font><br/>
<font color="#222222">OS-1510 DTrace helper tracing should be dynamic</font><br/>
<font color="#222222">OS-1511 overly aggressive D integer narrowing breaks 32-bit ustack helpers</font><br/>
<font color="#222222">OS-1513 misplaced ASSERT in OS-1247 breaks DEBUG bits</font><br/>
<font color="#222222">OS-1517 Add support for I350 Serdes</font><br/>
<font color="#222222">OS-1507 ipd can blow an assertion when status is requested on a disabled zone OS-1508 ipd needs a stable library</font><br/>
<font color="#222222">OS-1054 lofiadm in current smartos can't use &#45;U to uncompress an lgz image code review by Robert Mustacchi</font><br/>
<font color="#222222">OS-1497 Increase svc.startd critical_failure_count range from 5 to 10 code reviewed by Bill Pijewski</font><br/>
<font color="#222222">OS-1491 SYSOPS-4940 svc.startd incorrectly placing services into maintenance mode code reviewed by Robert Mustacchi</font><br/>
<font color="#222222">OS-1520 ipmitool should be using patches</font></p>

<p><font color="#222222">kvm</font><br/>
<font color="#222222">&#45;-&#45;</font><br/>
<font color="#222222">HVM-746 kvm makefile does not properly create all necessary paths.</font></p>

<p><font color="#222222">kvm-cmd</font><br/>
<font color="#222222">&#45;-----&#45;</font><br/>
<font color="#222222">HVM-747 add dmods to get event indexes</font></p>


<h2><a name="SmartOSChangeLog-August24%2C2012"></a>August 24, 2012</h2>

<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;----------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; smartos-live#94 zone brands need to be more resiliant to missing nic tags</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1487 Add bash tab completion for dladm delete-vnic and delete-etherstub</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1481 0-livesrc-stamp not removed due to typo</font><br/>
<font color="#222222">&nbsp; &nbsp; Merge pull request #95 from nshalman/build_usb</font><br/>
<font color="#222222">&nbsp; &nbsp; tools/build_usb: build a usb image from scratch</font><br/>
<font color="#222222">&nbsp; &nbsp; HEAD-1210 crontab sdc-lastcomm error on smartos</font><br/>
<font color="#222222">&nbsp; &nbsp; STOR-72 storage configuration for log and cache devices</font><br/>
<font color="#222222">&nbsp; &nbsp; STOR-26 Storage configuration with many disks should create sane RAID groups</font><br/>
<font color="#222222">&nbsp; &nbsp; STOR-72 storage configuration for log and cache devices</font><br/>
<font color="#222222">&nbsp; &nbsp; STOR-99 setup must support intelligent pool layout</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1467 illumos-live manifest changes are ignored on incremental</font><br/>
<font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;------------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1483 ps should have dmodel as an output format</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1486 vrrpadm should work with a vnic as its link</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1485 panic when reading from dump device with REMOVED/FAULTED vdev</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1484 lack of "smbfs" in /etc/dfs/fstypes prevents mounting during zone boot</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1454 Look at packaging ipcs and ipcclean into a package in pkgsrc</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1480 resolve upgrade hiccups around ZFS checksum values</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1473 shutdown(1) should broadcast shutdown warnings to all zones like wall(1)</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1470 mdb_tab.c mismerge</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1469 ship zpool-features man page</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1455 mdb_v8 misconfigures itself</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1468 mdb_v8 shouldn't abort auto-configuration on errors</font><br/>
<font color="#222222">illumos-extra</font><br/>
<font color="#222222">&#45;-----------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1462 running openvpn can reliably crash smartos joyent_20120726T184637Z</font><br/>
<font color="#222222">kvm</font><br/>
<font color="#222222">&#45;-&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp; HVM-742 off-by-one error in bitset manipulation</font><br/>
<font color="#222222">&nbsp; &nbsp; OS-1450 panic in list_remove() from kvm_mmu_free_page()</font></p>

<h2><a name="SmartOSChangeLog-August9%2C2012"></a>August 9, 2012</h2>

<p><font color="#222222">Notes: This build includes a sync with illumos upstream.</font></p>

<p><font color="#222222">Changelog:</font></p>

<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;----------&#45;</font><br/>
<font color="#222222">smartos-live#108 fix failed match on quick lookup if property type is not string (Thanks MerlinDMC)</font><br/>
<font color="#222222">OS-1463 remove double quotes from serial number in sysinfo (Thanks jritorto&#33;)</font><br/>
<font color="#222222">IMGAPI-13: Robustify imgadm's fatal error/exception handling</font><br/>
<font color="#222222">STOR-104 diskinfo misinterprets nvlist, can't detect removable device</font><br/>
<font color="#222222">OS-1456 need a mechanism to detect solid state storage devices</font><br/>
<font color="#222222">OS-1448 sysinfo chokes if the bios has crazy characters in some fields (merge fix from jritorto)</font><br/>
<font color="#222222">Some older x86 Sun hardware has a double-quote in the on-BIOS serial number and SKU which causes sysinfo to fail.</font><br/>
<font color="#222222">OS-1444 workaround kvm instability on sandy bridge</font><br/>
<font color="#222222">OS-1442 mpt_sas wants to bind to 1000,86</font></p>

<p><font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;------------&#45;</font><br/>
<font color="#222222">OS-1464 Fix IPMI detection on HP N36L / N40L</font><br/>
<font color="#222222">OS-1456 need a mechanism to detect solid state storage devices</font><br/>
<font color="#222222">OS-1350 Document BSD ps args</font><br/>
<font color="#222222">OS-1447 hung mount in one zone shouldn't interfere with zone boot/halt of another zone</font><br/>
<font color="#222222">OS-1438 `man tail` doesn't mentioned "-F" option</font><br/>
<font color="#222222">OS-1451 tail &#45;f does not deal properly with multiple files</font><br/>
<font color="#222222">OS-1429 `tail &#45;f ...` doesn't notice file truncation</font><br/>
<font color="#222222">dtrace: Remove CTF label checking</font><br/>
<font color="#222222">OS-1443 Refactor prtconf &#45;d output</font><br/>
<font color="#222222">OS-1445 `zpool get ...` broken after illumos sync</font><br/>
<font color="#222222">OS-1439 zfs force umount can leak zone ref, preventing zone shutdown</font><br/>
<font color="#222222">OS-1391 zone won't halt; vfs ref count is 1</font><br/>
<font color="#222222">2445 savecore fails with dump archive but return EXIT_OK</font><br/>
<font color="#222222">653 incorrect handling in iscsit of duplicate PDUs with cmdsn &gt; expsn</font><br/>
<font color="#222222">3021 option for time-ordered output from dtrace(1M)</font><br/>
<font color="#222222">3022 DTrace: keys should not affect the sort order when sorting by value 3023 it should be possible to deref</font><br/>
<font color="#222222">2599 git-pbchk suffers classic pipe deadlock</font><br/>
<font color="#222222">417 Stale OpenOwner entries are not reaped for active clients</font><br/>
<font color="#222222">2447 beadm should be more descriptive about some errors</font><br/>
<font color="#222222">2978 ctfconvert still needs to ignore legitimately dataless files on SPARC</font><br/>
<font color="#222222">2762 zpool command should have better support for feature flags</font><br/>
<font color="#222222">2945 mdb needs to export &#95;mdb_ks_pageoffset</font><br/>
<font color="#222222">2991 Allow building without SMB printing support</font><br/>
<font color="#222222">2974 hate having heap of hsfs headers 2977 ISO_DESC_TYPE should return iso_voldesc_type as everyone expects</font><br/>
<font color="#222222">1796 "ZFS HOLD" should not be used when doing "ZFS SEND" from a read-only pool</font><br/>
<font color="#222222">2871 support for &#95;_ZFS_POOL_RESTRICT used by ZFS test suite 2903 zfs destroy &#45;d d</font><br/>
<font color="#222222">2676 'mdb &#45;f vmdump.0' ignores the &#45;f</font><br/>
<font color="#222222">2950 sync hald-runner with upstream</font><br/>
<font color="#222222">2941 need to protect &#95;_RESTRICT_KYWD from foolish compilers</font><br/>
<font color="#222222">2942 CTF tools need to handle files which legitimately lack data</font><br/>
<font color="#222222">1973 ctfconvert VLA support is broken (again) for DWARF objects</font><br/>
<font color="#222222">2882 implement libzfs_core 2883 changing "canmount" property to "on" should not always remount dataset</font><br/>
<font color="#222222">2900 "zfs snapshot" should be able to create multiple, ar</font><br/>
<font color="#222222">2741 format shouldn't allow write SMI label to disk with EFI partition</font><br/>
<font color="#222222">1799 ipadm create-addr arg validation crash</font><br/>
<font color="#222222">2724 snoop contains few problems with accessing uninitialized data</font><br/>
<font color="#222222">2910 svc.startd core dump</font><br/>
<font color="#222222">2801 svc.startd leaks significant amount of memory</font><br/>
<font color="#222222">2891 After integration of OS-1168 svc.startd has no umem debugging in debug build</font><br/>
<font color="#222222">2881 usbftdi needs support for the SheevaPlug JTAG adapter</font><br/>
<font color="#222222">2901 ZFS receive fails for exabyte sparse files</font><br/>
<font color="#222222">2602 mdb ::sockparams SEGV</font><br/>
<font color="#222222">2894 ls(1) &#45;1U can go much faster</font><br/>
<font color="#222222">2076 blkdev can fail successful xfer if DMA is not used</font><br/>
<font color="#222222">2044 Move container_of and ARRAY_SIZE to sys/sysmacros.h</font><br/>
<font color="#222222">2042 blkdev should not discard bd-&gt;d_maxxfer</font><br/>
<font color="#222222">1910 Implement a generic dev_err</font><br/>
<font color="#222222">1882 blkdev should limit physio by bd-&gt;d_maxxfer instead of maxphys</font><br/>
<font color="#222222">1430 blkdev crashes on synchronous flushes</font><br/>
<font color="#222222">1342 Bogus assert in bd_xfer_alloc</font><br/>
<font color="#222222">1450 Illumos should be buildable with GCC4</font><br/>
<font color="#222222">2804 psrinfo should not depend on perl</font><br/>
<font color="#222222">2873 sysretq doesn't properly handle non-canonical addresses</font><br/>
<font color="#222222">2574 mdb needs ::printf</font><br/>
<font color="#222222">2614 nfs logging works incorrectly</font><br/>
<font color="#222222">2618 arc.c mistypes in the comments</font><br/>
<font color="#222222">2831 bring Joyent/SmartOS OS-1186 and OS-1187 to Illumos (fix lint, copyright)</font><br/>
<font color="#222222">2831 bring Joyent/SmartOS OS-1186 and OS-1187 to Illumos</font><br/>
<font color="#222222">2562 FCoE iniator mistreats its ints</font><br/>
<font color="#222222">2803 zfs get guid pretty-prints the output</font><br/>
<font color="#222222">backout 2614: packaging errors (incomplete - no nightly build)</font><br/>
<font color="#222222">2812 FMA generic topology support for AMD family 0x10 model 10</font><br/>
<font color="#222222">2802 ipsecalgs needs a dependency upon filesystem</font><br/>
<font color="#222222">2614 nfs logging works incorrectly</font><br/>
<font color="#222222">2730 tar misbehaves if compress utility missing</font><br/>
<font color="#222222">2731 add &#45;a &#45;-auto feature to tar for gtar comptability</font><br/>
<font color="#222222">2810 pmconfig linked against libcmd</font><br/>
<font color="#222222">2058 libumem should allow you to specify an allocator</font><br/>
<font color="#222222">2049 env(1) should print program it attempts to exec on error, not argv[0]</font><br/>
<font color="#222222">2785 /lib/svc/bin/restore&#95;</font><font color="#222222">repository incorrectly uses &#45;eq on strings</font><br/>
<font color="#222222">1991 svccfg describe &#45;t Segmentation Fault</font><br/>
<font color="#222222">2742 minor memory allocation issue in svccfg:upgrade_manifestfiles()</font><br/>
<font color="#222222">2777 mpt_sas needs to try MUR reset at attach() time.</font><br/>
<font color="#222222">1165 SUNWarbel/driver-network-arbel should be removed (fix packaging)</font><br/>
<font color="#222222">1165 SUNWarbel/driver-network-arbel should be removed</font><br/>
<font color="#222222">2619 asynchronous destruction of ZFS file systems (missed files)</font><br/>
<font color="#222222">2619 asynchronous destruction of ZFS file systems</font><br/>
<font color="#222222">2747 SPA versioning with zfs feature flags</font><br/>
<font color="#222222">1572 Missing PCI ID for SK-9E21D (yge)</font><br/>
<font color="#222222">2705 EOF libldap.so.4</font><br/>
<font color="#222222">2744 libuuid can't tell when mapping fails</font><br/>
<font color="#222222">2654 add ixgbe support for new x520 models</font><br/>
<font color="#222222">344 su fails to check malloc's return value</font><br/>
<font color="#222222">405 Can't connect to similarly-named, encrypted wireless networks.</font><br/>
<font color="#222222">356 tar command needs to add the "J" switch and XZ compression support</font><br/>
<font color="#222222">2675 EOF itutools</font><br/>
<font color="#222222">2733 pgrep/pkill prints misleading error on missing option argument</font><br/>
<font color="#222222">2717 tail is not largefile aware</font><br/>
<font color="#222222">2710 DTrace can cause build failures if the kernel's CTF data is corrupt</font><br/>
<font color="#222222">2701 Add tab completion support for mdb</font><br/>
<font color="#222222">2655 illumos should be lint 12.3 free</font><br/>
<font color="#222222">2703 add mechanism to report ZFS send progress</font><br/>
<font color="#222222">2666 libhal should be more carefull about function parameters</font><br/>
<font color="#222222">2667 libhal can leak memory if realloc() fails</font><br/>
<font color="#222222">2690 etc/inet/services needs some new entries</font><br/>
<font color="#222222">2698 libctf should use libz.so.1, not libz.so</font><br/>
<font color="#222222">1618 zfs causing system to hang in vmem_xalloc()</font></p>

<p><font color="#222222">illumos-extra</font><br/>
<font color="#222222">&#45;-----------&#45;</font><br/>
<font color="#222222">OS-1433 platform node should use libumem</font></p>

<p><font color="#222222">kvm</font><br/>
<font color="#222222">&#45;-&#45;</font><br/>
<font color="#222222">HVM-742 off-by-one error in bitset manipulation</font><br/>
<font color="#222222">OS-1450 panic in list_remove() from kvm_mmu_free_page()</font></p>

<p><font color="#222222">kvm-cmd</font><br/>
<font color="#222222">&#45;-----&#45;</font><br/>
<font color="#222222">HVM-741 add SmartOS gPXE patch that was applied for OS-1153</font><br/>
<font color="#222222">HVM-740 want a basic dmod for qemu</font><br/>
<font color="#222222">HVM-737 Add kvm-cmd xref target</font><br/>
<font color="#222222">HVM-721 kvm-cmd builds too many times</font><br/>
<font color="#222222">HVM-735 qemu should build with V=1</font><br/>
<font color="#222222">HVM-736 Qemu is missing a call to ctfmerge</font></p>


<h2><a name="SmartOSChangeLog-July26%2C2012"></a>July 26, 2012</h2>

<p>Changes in this build:</p>

<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;--------------&#45;</font><br/>
<font color="#222222">OS-1397 Add Cron Manifest to the Joyent-Minimal Brand</font><br/>
<font color="#222222">OS-1402 joyent-minimal should support manifest that aren't imported</font><br/>
<font color="#222222">OS-1401 Add vrrp service to zones</font><br/>
<font color="#222222">OS-1398 zonememstat should ensure columns align</font><br/>
<font color="#222222">OS-1395 kernel should not kill a GZ process preventing zone shutdown if process is not a shell or child of a shell</font><br/>
<font color="#222222">OS-1394 Platform build should fail if we are not mancheck &#45;s clean</font></p>

<p><font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;-----------------&#45;</font><br/>
<font color="#222222">OS-1405 CPU caps can throttle performance more than intended</font><br/>
<font color="#222222">OS-1406 mdb_v8 doesn't work on node v0.8</font><br/>
<font color="#222222">OS-1392 unnecessary conversion of double to uint64_t in iob_bytes2str()</font><br/>
<font color="#222222">OS-1396 sendmail svcs in error</font><br/>
<font color="#222222">OS-1355 ship man pages that are present but missing</font><br/>
<font color="#222222">OS-1386 SSH key fingerprint not deposited in the auth logfile.</font><br/>
<font color="#222222">OS-1367 need ptcumem</font></p>

<p><font color="#222222">illumos-extra</font><br/>
<font color="#222222">&#45;----------------&#45;</font></p>

<p><font color="#222222">OS-1403 bind and ntp don't ship man pages</font><br/>
<font color="#222222">OS-1355 ship man pages that are present but missing</font><br/>
<font color="#222222">OS-1388 illumos-extra node build failure</font></p>

<p><font color="#222222">illumos-kvm</font><br/>
<font color="#222222">&#45;--------------&#45;</font><br/>
<font color="#222222">illumos-kvm#9 Don't use the obsolete &#45;fno-dwarf2-indirect-strings</font><br/>
<font color="#222222">HVM-734 Makefile does not create devfsadm directory</font></p>


<h2><a name="SmartOSChangeLog-July13%2C2012"></a>July 13, 2012</h2>

<p>Changes in this build:</p>

<p>smartos-live<br/>
&#45;----------&#45;<br/>
smartos-live#97 rtl8136 should be rtl8139 in vmadm man page<br/>
OS-1374 don't try to open hostname.net0 when the brand doesn't need it.<br/>
OS-1375 implement remove_disks for update and prevent &#42;_disks from working while VM is running, add tests.<br/>
Use pkg_info &#45;qe rather than redirecting output.<br/>
RELENG-350 switch to /opt/local/bin/node for man build.<br/>
OS-1372 switch ronnjs to use platform node instead of /usr/bin/env node<br/>
OS-1325 fix creation of VM with no quota, add tests for quota creation.<br/>
OS-1216 fix test that failed to include correct path the VM.js<br/>
OS-1322: media type should be kept when creating an additional disk<br/>
OS-1323: allow path to ISO as path: option for a disk (in which case not requiring size)<br/>
OS-951 allow multiple cdrom= options to 'vmadm start'<br/>
HEAD-1131 add switch for enabling tests<br/>
OS-1362 move VM tests into the platform<br/>
OS-1358 mancheck should support only showing missing or non-shipping manual pages<br/>
OS-1354 need tool to check for missing manual pages for binaries</p>

<p>illumos-joyent<br/>
&#45;------------&#45;<br/>
OS-1384 ::kmastat overflows columns with inscrutable output<br/>
OS-1378 add "%H" to mdb_printf() for human-readable sizes<br/>
OS-1381 incorrect isaexec binaries<br/>
OS-1373 startd, configd spinning due to bad sac start method<br/>
OS-1376 cputrack isa-dependent binaries missing from image<br/>
OS-1287 svc.startd gets stuck in a loop when HOME dir doesn't exist<br/>
OS-1344 a misconfigured smf service can cause svc.configd to leak memory and eventually hang<br/>
STOR-98 rework RAID-Z crash dump comments based on review<br/>
OS-1351 ps - missing column separator<br/>
OS-1359 remove some unneeded cmds from the image<br/>
OS-1343 fast localhost connections choke in TCP TIME_WAIT<br/>
OS-1364 local auditors specifying LA_FLG_BINDTO miss bindings via elf_bndr()</p>

<p>illumos-extra<br/>
&#45;-----------&#45;</p>

<p>OS-1381 incorrect isaexec binaries<br/>
OS-1370 pass V=1 or equivalent to &#45;extra components whenever possible<br/>
OS-1290 switch platform's node to using system libz and openssl<br/>
OS-1342 add environment variable we can set to disable node version check in dev.<br/>
AGENT-490 pull in v0.8 branch node changes up to f00c8bc</p>

<h2><a name="SmartOSChangeLog-June29%2C2012"></a>June 29, 2012</h2>

<p>Changes in this build:</p>

<p>illumos-joyent<br/>
&#45;------------&#45;<br/>
OS-1336 Ship dis<br/>
OS-1338 for local auditors, LA_FLG_BINDTO does not audit all symbol bindings<br/>
STOR-97 nits from initial RAID-Z crash dump review<br/>
STOR-76 support crash dumps to pools with multiple vdevs<br/>
STOR-69 support crash dumps on pools with log, cache, and spare devices<br/>
OS-1321 log a message when svc.startd core dumps<br/>
smartos-live#51 No symlink for libusb.so to libusb.so.1 for &#45;lusb<br/>
smartos-live#91 make world fails on trying to include zlib.h<br/>
OS-1303 smartos-live src_addon can die<br/>
OS-1306 non-bootstrappable runtime dependencies should be isolated<br/>
OS-1308 illumos-joyent should support using pkgsrc libraries for native ...<br/>
OS-1314 kvm.so is wrongly built as if it were a kmod<br/>
OS-1317 GZ crle configuration pollution<br/>
OS-1320 64-bit C+&#43; objects in illumos are still getting gcc DT_RPATH<br/>
OS-1278 svc.startd core dump<br/>
OS-1297 need workaround for QEMU bug that induces bad e1000g checksums<br/>
OS-1292 mail is not being delivered</p>

<p>smartos-live<br/>
&#45;----------&#45;<br/>
smartos-live#87 fixed a problem with DSadm and multople sources.<br/>
OS-1348 fix javascriptlint to build against correct python.<br/>
OS-1348 fix 'make check' target and also have it javascriptlint build properly on OS X.<br/>
OS-1347 ensure zone has completely transitioned when waiting for transition.<br/>
OS-1346 workaround node changing behavior of exit in 0.8<br/>
OS-1262 - fixed js files to handle changes required for running under 0.8<br/>
OS-1261 - fixed dependencies in platform .js files to explicitly refer to the platform node_modules<br/>
OS-1257 - fixed paths for node to point to /usr/node/bin/node<br/>
OS-1339 - moved node-sqlite3 to smartos-live build for inclusion in platform (built against platform node)<br/>
OS-1329 fix /opt/SUNWspro/sunstudio12.1 link.<br/>
OS-1327 smartos-live Makefile clobbers BUILDSTAMP through variable auto-export<br/>
OS-1301 smartos-live subprojects should be told about the proto area (fix path)<br/>
smartos-live#2 Fixed identation, spaces should be tabs<br/>
smartos-live#51 No symlink for libusb.so to libusb.so.1 for &#45;lusb<br/>
smartos-live#86 'make clean' fails if Node.js hasn't been built<br/>
smartos-live#91 make world fails on trying to include zlib.h<br/>
OS-1301 smartos-live subprojects should be told about the proto area<br/>
OS-1302 smartos-live should offer a way to bootstrap illumos-extra<br/>
OS-1303 smartos-live src_addon can die<br/>
OS-1304 smartos-live src build should not use node-waf<br/>
OS-1305 illumos-extra should not put libuuid.a into the proto area, ever<br/>
OS-1306 non-bootstrappable runtime dependencies should be isolated<br/>
OS-1310 smartos-live build doesn't fail even if kvm-cmd completely bombs out<br/>
OS-1312 smartos-live makefiles must fit in 80 columns<br/>
OS-1317 GZ crle configuration pollution<br/>
OS-1295 Man page fixes for COLUMNS=80<br/>
OS-1292 mail is not being delivered</p>

<p>kvm<br/>
&#8212;<br/>
HVM-732 README refers to wrong gcc version<br/>
OS-1298 kvm builds mdb module against the build system's headers<br/>
OS-1299 kvm is still using Studio<br/>
OS-1314 kvm.so is wrongly built as if it were a kmod</p>

<p>kvm-cmd<br/>
&#45;-----&#45;<br/>
OS-1335 kvm-cmd libpng build needs to learn to be 64-bit<br/>
OS-1300 kvm-cmd build system relies on build system headers and libraries</p>

<h2><a name="SmartOSChangeLog-June14%2C2012"></a>June 14, 2012</h2>

<p>Changes in this release:</p>

<ul>
	<li>Fix to correct behavior when using "allow_ip_spoofing" on zone NICs</li>
	<li>Fix for <a href="http://www.kb.cert.org/vuls/id/649219">http://www.kb.cert.org/vuls/id/649219</a></li>
	<li>More dtrace probe points in zones. (See <a href="http://dtrace.org/blogs/bmc/2012/06/07/dtrace-in-the-zone/">http://dtrace.org/blogs/bmc/2012/06/07/dtrace-in-the-zone/</a> for a deeper explanation.)</li>
	<li>"dsadm" is being renamed to "imgadm". You can continue to use "dsadm" for now.
<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>For a tip on how to migrate from an earlier release to the 20120614 release, see this&nbsp;<a href="Migrating from an earlier release to the 20120614 Release.html" title="Migrating from an earlier release to the 20120614 Release">topic</a>.</td></tr></table></div></li>
	<li>...and more, see full changelogs below</li>
</ul>



<p>smartos-live</p>

<p>&#45;--------------&#45;</p>

<p>OS-1268 vmadm commands to enable ip_spoofing don't un-set the "allowe...d_ips" linkprop<br/>
OS-1285 fix tests for vmtest.js / test-blocksize.js image import failure<br/>
OS-1280: imgadm.js should export its log and config objects so they can be configured<br/>
OS-1277: Add support for returning Number-type values<br/>
OS-1272 add datacenter_name and headnode_id keys to VM objects so they're available as sdc: metadata<br/>
OS-807 zones can commit suicide by zvol<br/>
OS-1249 add list of commands and brief summary of each to imgadm's usage message.<br/>
OS-1251 fix and restyle img&#42; bits to pass jsstyle and jslint (with 'make check') and match the style of the other JS bits in the smartos-live/src dir.<br/>
OS-1250 replace link for dsadm man page with imgadm man page<br/>
OS-1250 add symlink so that docs that use the old dsadm name still work for the time being.<br/>
OS-1250 rename dsadm &#45;&gt; imgadm as we've settled on the name 'images' for the zvol and zfs blobs you download and use as templates to create a mVM.<br/>
OS-1264 add support for boot time in sysinfo for both GZ and NGZ.<br/>
HVM-731 catch exception when zoneroot is full and we try booting a KVM VM (can't create /startvm).<br/>
OS-1163 bump 'cores' quota for all brands to the larger of 100G or DRAM + 20G<br/>
OS-1256 have run-test and run-tests exit non-zero when tests fail.<br/>
OS-1242 remove vmadm call from joyent&#42; brand jinstall scripts to speed up creation of large numbers of machines.<br/>
OS-1243 joyent brand hooks refer to map, capi, etc.</p>

<p>illumos-joyent</p>

<p>&#45;-----------------&#45;<br/>
OS-37 add missing man pages<br/>
OS-1289 nm has no man page<br/>
OS-1288 sysretq doesn't properly handle non-canonical addresses<br/>
OS-1274 Sendmail at /usr/lib/sendmail missing config file<br/>
OS-1283 remove misleading README.joyent file<br/>
OS-1276 /etc/sulogin doesn't exist in the GZ<br/>
OS-807 zones can commit suicide by zvol<br/>
OS-1260 zoneadmd core dump in mcap_zone()<br/>
OS-1247 need limited access to some DTrace providers in the non-globa...<br/>
OS-1237 need to be able to access fds[] from a non-global zone</p>


<h2><a name="SmartOSChangeLog-May31%2C2012"></a>May 31, 2012</h2>

<p><font color="#222222">Notes:</font></p>

<p><font color="#222222">We're now checking that the zpool parameter in your vmadm payloads is an actual zpool, dataset_uuid and image_uuid are actually UUIDs, along with other validation that your payload is correct.  If you have problems please consult the man page for proper payload options.</font></p>

<p><font color="#222222">Changes in this release:</font></p>

<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;----------&#45;</font><br/>
<font color="#222222">OS-1239 fix removal of invalid nics.&#42; parameters from payloads.</font><br/>
<font color="#222222">OS-1235 add support for allow_unfiltered_promisc option for KVM VM's vnics.</font><br/>
<font color="#222222">OS-1241 kvm prestate and poststate scripts should call kvm's statechange.</font><br/>
<font color="#222222">OS-1240 switch tests to joyent-minimal instead of joyent.</font><br/>
<font color="#222222">OS-1236 fix sysinfo to not try to use polo which is gone.</font><br/>
<font color="#222222">OS-1232 replace build-user-script with add-userscript which can handle create and update</font><br/>
<font color="#222222">OS-1231 add support for joyent-minimal to metadata agent.</font><br/>
<font color="#222222">OS-1230 fix mdata:fetch service to be enabled by default in joyent-minimal zones.</font><br/>
<font color="#222222">OS-1217 add support for joyent-minimal, refactor handling of properties and add tests.</font><br/>
<font color="#222222">OS-1193 vmadm: support disabling antispoof on nics</font><br/>
<font color="#222222">OS-1224 upgrade /usr/bin/json to 3.1.2</font><br/>
<font color="#222222">OS-1213 Add tests for setting fs_allowed.</font><br/>
<font color="#222222">OS-1226 illumos-live now provides Joyent.xml</font><br/>
<font color="#222222">OS-1221 Want Joyent minimal brand</font><br/>
<font color="#222222">OS-1222 Need a tool to create smf seed repositories</font><br/>
<font color="#222222">OS-1218 move more sdc-specific code out of illumos-joyent</font><br/>
<font color="#222222">OS-1038 add support for zfs compression, volblocksize and recsize options.</font><br/>
<font color="#222222">OS-1215 enable per-brand smf manifest lists</font><br/>
<font color="#222222">OS-1214 move sdc-specific zone SMF method out of illumos-joyent</font><br/>
<font color="#222222">OS-1212 fix regression in creation of delegated datasets.</font><br/>
<font color="#222222">OS-1211 switched to using &#45;F when cloning KVM images.</font><br/>
<font color="#222222">OS-1185 fix bug in resizing ram where max_swap is added as string.</font><br/>
<font color="#222222">OS-858 add experimental support for VM.send, VM.receive, VM.install to VM.js and vmadm</font><br/>
<font color="#222222">OS-952 started update of illumos-live toward JEG</font><br/>
<font color="#222222">STOR-33 added VM.send and VM.receive to serve as a start toward backup/restore</font></p>

<p><font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;------------&#45;</font><br/>
<font color="#222222">OS-430 dtrace in a zone can't see "cpu"</font><br/>
<font color="#222222">OS-535 want curpsinfo-&gt;pr_dmodel inside zones</font><br/>
<font color="#222222">OS-1238 ship mcs</font><br/>
<font color="#222222">OS-1155 allow vnics to be unfiltered in promiscuous mode</font><br/>
<font color="#222222">OS-1226 illumos-joyent no longer provides Joyent.xml</font><br/>
<font color="#222222">OS-1220 dependencies on manifest-import should always be optional_all</font><br/>
<font color="#222222">OS-1219 svc.configd should reduce footprint by setting "nomagazines"</font><br/>
<font color="#222222">OS-1218 move more sdc-specific code out of illumos-joyent</font><br/>
<font color="#222222">OS-1215 enable per-brand smf manifest lists</font><br/>
<font color="#222222">OS-1214 move sdc-specific zone SMF method out of illumos-joyent</font><br/>
<font color="#222222">OS-792 dladm show-linkprop &#45;z zonename doesn't restrict output to that zone, unless you also specify the vnic name</font><br/>
<font color="#222222">OS-1154 update zfs manpage to reflect new get &#45;c option</font></p>

<h2><a name="SmartOSChangeLog-May17%2C2012"></a>May 17, 2012</h2>

<p><font color="#222222">Changes in this release:</font></p>

<p><font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;------------&#45;</font><br/>
<font color="#222222">OS-1169 fix for OS-493 generates warning on Sun Studio build</font><br/>
<font color="#222222">OS-1205 mdb_v8 is confused by some invalid objects</font><br/>
<font color="#222222">OS-1207 missing cpustat and cputrack man pages and cputrack cmd</font><br/>
<font color="#222222">OS-932 want SMB binaries and services in platform</font><br/>
<font color="#222222">OS-1189 BAD TRAP panic in hyprlofs_seek</font><br/>
<font color="#222222">OS-1188 memory leak in restarter_get_method_context()</font><br/>
<font color="#222222">OS-1187 svc.startd should reduce footprint by setting "nomagazines"</font><br/>
<font color="#222222">OS-1186 svc.startd allocates excessive memory for instance names</font><br/>
<font color="#222222">OS-1168 svc.startd should not enable libumem debugging</font><br/>
<font color="#222222">OS-1179 zoneadmd re-parses zone's xml config file many times during state transitions</font><br/>
<font color="#222222">OS-1170 update zones to support setting custom init</font><br/>
<font color="#222222">OS-1154 ::walk jsframe sometimes bails too early</font><br/>
<font color="#222222">OS-1180 jstack could be better with native frames</font><br/>
<font color="#222222">OS-1181 loading mdb_v8 should turn on C+&#43; demangling</font><br/>
<font color="#222222">OS-1182 mdb_v8 reports wrong file position</font><br/>
<font color="#222222">HEAD-1047 root cron jobs aren't being run at all</font><br/>
<font color="#222222">OS-1162 need ipadm.1m man page; create one from PSARC materials and source</font><br/>
<font color="#222222">OS-1174 ::help tab completion</font><br/>
<font color="#222222">OS-1175 ::printf tab completion</font><br/>
<font color="#222222">OS-1176 add missing man3contract man pages.</font><br/>
<font color="#222222">OS-1081 /usr/gnu contents are severely broken wrt ISA</font><br/>
<font color="#222222">OS-1121 platform delivers unwanted compilation symlinks</font><br/>
<font color="#222222">OS-1123 libstdc+&#43; and libgcc_s should move to /usr</font><br/>
<font color="#222222">1168 want a libtermcap that does not force libcurses</font><br/>
<font color="#222222">2698 libctf should use libz.so.1, not libz.so</font><br/>
<font color="#222222">OS-1171 re-enable building smbd</font><br/>
<font color="#222222">OS-1159 minimize zone footprint</font><br/>
<font color="#222222">OS-1165 fix up illumos issue 1948</font><br/>
<font color="#222222">STOR-54 warnings when creating a delegated ZFS dataset in a non-global zone</font><br/>
<font color="#222222">OS-493 NFS client 'entity not found' error when mounting</font><br/>
<font color="#222222">OS-1158 add ilb (load balancer) svc to zones</font><br/>
<font color="#222222">OS-1133 need ::findjsobjects</font><br/>
<font color="#222222">OS-1149 update to latest acpica release; transition to ACPI 5.0</font><br/>
<font color="#222222">OS-1119 add lxproc, a coarsely Linux-compatible /proc</font><br/>
<font color="#222222">OS-1008 TERM support missing for xterm-color 256 color, screen and tmux</font><br/>
<font color="#222222">OS-994 ZFS hang when snapshotting and cloning</font><br/>
<font color="#222222">OS-1134 ZFS rollback hang</font><br/>
<font color="#222222">OS-1141 missing fma topo support</font><br/>
<font color="#222222">OS-1115 update libipmi and fma to use /dev/ipmi instead of /dev/bmc</font><br/>
<font color="#222222">OS-1139 mdb tab completion</font><br/>
<font color="#222222">OS-1138 ipmi driver should copyin/copyout addr and lun ioctl parameter</font><br/>
<font color="#222222">OS-1129 force the enabling of &#45;o xtrace in zoneinit for older datasets.</font><br/>
<font color="#222222">OS-1136 replace builtin /dev/bmc devlink generator with /dev/ipmi</font><br/>
<font color="#222222">OS-1131 Want a library to allow programatic access to the pci database</font><br/>
<font color="#222222">OS-919 prtconf should print out PCI database information</font><br/>
<font color="#222222">OS-782 need to record timestamp when calling through context ops</font><br/>
<font color="#222222">OS-101 bmc driver is missing which makes ipmi not work locally; port freebsd openipmi driver</font><br/>
<font color="#222222">OS-1079 polkit is mislinked</font><br/>
<font color="#222222">OS-1080 HAL and its plugins are mislinked</font><br/>
<font color="#222222">OS-1086 mdb disassembler confuses rdtscp for invlpg</font></p>

<p><font color="#222222">In addition, this tree is synced with mainline illumos up to commit 09a48d4, "2668 syntax error in terminfo.src trips uninitialized var in tic, screws terminfo"</font></p>


<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;----------&#45;</font></p>

<p><font color="#222222">OS-932 want SMB binaries and services in platform</font><br/>
<font color="#222222">OS-1190 gmake update fails if illumos-extra tarball is used</font><br/>
<font color="#222222">HEAD-1046 sdc-phonehome runs at 0100 UTC for everyone</font><br/>
<font color="#222222">HEAD-1060 need to update logadm.conf for rsyslog</font><br/>
<font color="#222222">OS-1173 add build-user-script tool to assist in adding user-scripts to VMs.</font><br/>
<font color="#222222">OS-1123 libstdc+&#43; and libgcc_s should move to /usr</font><br/>
<font color="#222222">OS-1159 minimize zone footprint</font><br/>
<font color="#222222">OS-1128 when deleting a VM ensure that it's gone or return a failure.</font><br/>
<font color="#222222">OS-1158 add ilb (load balancer) svc to zones</font></p>


<h2><a name="SmartOSChangeLog-May3%2C2012"></a>May 3, 2012</h2>

<p><font color="#222222">kvm-cmd</font><br/>
<font color="#222222">&#45;-----&#45;</font><br/>
<font color="#222222">OS-1153 Update to a gpxe rom for e1000 built from the stable-1.0.1 branch of gPXE with a patch that allows booting SmartOS.</font></p>

<p><font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;------------&#45;</font><br/>
<font color="#222222">OS-1139 mdb tab completion</font><br/>
<font color="#222222">OS-1119 add lxproc, a coarsely Linux-compatible /proc</font><br/>
<font color="#222222">OS-1008 TERM support missing for xterm-color 256 color, screen and tmux</font><br/>
<font color="#222222">OS-1131 Want a library to allow programatic access to the pci database</font><br/>
<font color="#222222">OS-919 prtconf should print out PCI database information</font></p>

<p><font color="#222222">OS-994 ZFS hang when snapshotting and cloning</font><br/>
<font color="#222222">OS-1134 ZFS rollback hang</font><br/>
<font color="#222222">OS-1141 missing fma topo support</font><br/>
<font color="#222222">OS-1115 update libipmi and fma to use /dev/ipmi instead of /dev/bmc</font><br/>
<font color="#222222">OS-1138 ipmi driver should copyin/copyout addr and lun ioctl parameter</font><br/>
<font color="#222222">OS-1129 force the enabling of &#45;o xtrace in zoneinit for older datasets.</font><br/>
<font color="#222222">OS-1136 replace builtin /dev/bmc devlink generator with /dev/ipmi</font><br/>
<font color="#222222">OS-782 need to record timestamp when calling through context ops</font><br/>
<font color="#222222">OS-101 bmc driver is missing which makes ipmi not work locally; port freebsd openipmi driver</font><br/>
<font color="#222222">OS-1079 polkit is mislinked</font><br/>
<font color="#222222">OS-1080 HAL and its plugins are mislinked</font><br/>
<font color="#222222">OS-1086 mdb disassembler confuses rdtscp for invlpg</font></p>

<p><font color="#222222">smartos-live</font><br/>
<font color="#222222">&#45;----------&#45;</font><br/>
<font color="#222222">OS-1147 remove has_hvx.c and replace with isainfo</font><br/>
<font color="#222222">OS-1148 rename zfs_storage_pool_name to zpool, include deprecation warning and backward compat.</font><br/>
<font color="#222222">OS-1146 rename compute_node_uuid to server_uuid</font><br/>
<font color="#222222">OS-1135 add experimental support for KVM VMs running a SPICE dataset.</font><br/>
<font color="#222222">OS-1144 CURL_BIN should be CURL</font><br/>
<font color="#222222">HEAD-1020 sdc-phonehome is in smartos crontab</font><br/>
<font color="#222222">OS-1140 Fix man page for nics.*.model in man page (thanks Tenzer)</font><br/>
<font color="#222222">OS-1078 mdata api is in SmartOS but mdata-get tool is missing</font><br/>
<font color="#222222">OS-1116 update ipmitool to use the open ipmi dev instead of /dev/bmc</font><br/>
<font color="#222222">OS-101 bmc driver is missing which makes ipmi not work locally; port freebsd openipmi driver</font><br/>
<font color="#222222">HEAD-1017 prompt-config has no controlling terminal so some control characters don't work</font><br/>
<font color="#222222">OS-1125 fix detection of zpool.</font><br/>
<font color="#222222">AGENT-470 don't barf getting last_modified time when metadata.json or other file does not exist.</font><br/>
<font color="#222222">OS-1116 - back out until illumos repo is updated</font><br/>
<font color="#222222">AGENT-469 add last_modified timestamp for VMs</font></p>


<h2><a name="SmartOSChangeLog-April22%2C2012"></a>April 22, 2012</h2>

<p>JohnS says:&nbsp;"<font color="#222222">I apologize for the delay, but I wasn't willing to ship a release with a known security vulnerability ( OpenSSL CVE-2012-0884 ). This has been patched in the latest release."</font></p>

<p><font color="#222222">Changelog for this build:</font></p>

<p><font color="#222222">illumos-extra</font><br/>
<font color="#222222">&#45;-----------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1112 Need to update OpenSSL to latest stable (CVE-2012-0884)</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-719 Add parallel bzip2 to OS image</font></p>

<p><font color="#222222">illumos-joyent</font><br/>
<font color="#222222">&#45;------------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1104 'zfs list &#45;o volsize' no longer shows volsize</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1110 ipd max delay should be increased to 1 second</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-858 don't create dataset when installing a zone that already has a dataset.</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-914 Updated x86_archext with missing cpuid pieces</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1099 Want support for binutils 2.22</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1098 vmxnet breaks the studio shadow build</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1095 add /dev/tap and /dev/tun to joyent branded zones by default.</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1090 Need ixgbe support for X520 DP</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1082 dce_reclaim_thread stops making forward progress</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1096 More lib symlinks</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1087 To better support split / and /usr, svcadm command should be in /sbin and not /usr/sbin</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1085 Add symlink for /usr/ccs/bin/ar</font><br/>
<font color="#222222">&nbsp; &nbsp;HVM-728 Multicast isn't available to VMs</font></p>

<p><font color="#222222">illumos-live</font><br/>
<font color="#222222">&#45;---------&#45;</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1101 fix inconsistent use of default_gateway and warn as deprecated.</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1094 fix detection of conflicting IPs and MACs.</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1094 fix detection of conflicting IPs and MACs.</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1102 dsadm will occasionally mis-handle EPIPE</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1097 Update driver_aliases for ET2 Quad Port Server Adapter</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1091 Need /etc/driver_alises entries for the X520 and friends</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1096 More lib symlinks</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1089 add virtio_txtimer and virtio_txburst options for KVM VMs.</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1035 please make it clear how the merged crontabs work, with comments in the system cron text</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1084 allow primary to be set false on a NIC for create for purposes of building payloads from a template.</font><br/>
<font color="#222222">&nbsp; &nbsp;OS-1083 fix problems with vnic setup which caused multiple primary check to fail.</font><br/>
<font color="#222222">&nbsp; &nbsp;STOR-90 fix for STOR-89 is incorrect</font></p>

<h2><a name="SmartOSChangeLog-April5%2C2012"></a>April 5, 2012</h2>

<p><font color="#000000">smartos-live</font><br/>
<font color="#000000">&#45;----------&#45;</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1069 system-log svc method should generate rsyslog.conf if possible</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1066 configure and setup-build-zone glib process is busted</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1068 illumos-live Makefile PATH is a bit borken</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1066 configure and setup-build-zone glib process is busted</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1068 illumos-live Makefile PATH is a bit borken</font><br/>
<font color="#000000">&nbsp; &nbsp;STOR-89 want different ZFS /etc/system settings for SmartOS and SDC</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-48 Add universal tun/tap device to live image so we can use OpenVPN in a zone</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-715 deliver 'rsyslog' and make it the logd for the GZ</font><br/>
<font color="#000000">&nbsp; &nbsp;HEAD-980 dsadm sources.list doesnt make it to the right place</font></p>

<p><font color="#000000">illumos-joyent</font><br/>
<font color="#000000">&#45;------------&#45;</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1028 page-level corruption induces kernel panic</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1077 Update timezone info db to 2012c</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1063 Add a 'big theory' comment to FSS</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1064 rcapstat should direct you to zonememstat</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1058 libzfs_set_cachedprops() needs function header in libzfs.h</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1051 process starvation in FSS</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1059 new IP symbols need to be listed in symbol file</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1056 ip_dce_reclaim_stack() cannot be made perfectly safe</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1050 boot_time kstat for zones should be epoch timestamp of zone boot, not 'random' number</font><br/>
<font color="#000000">&nbsp; &nbsp;OS-1048 zfs list/get &#45;c to return only cached properties</font></p>


<h2><a name="SmartOSChangeLog-March22%2C2012"></a>March 22, 2012</h2>

<p><font color="#000000">smartos-overlay</font><br/>
<font color="#000000">&#45;--------------------&#45;</font><br/>
<font color="#000000">HEAD-980 dsadm sources.list copied on install</font></p>

<p><font color="#000000">smartos-live</font><br/>
<font color="#000000">&#45;--------------&#45;</font><br/>
<font color="#000000">OS-1043 minimize vm_getusage impact</font><br/>
<font color="#000000">OS-1052 Missing e1000g pci ids</font><br/>
<font color="#000000">OS-1013 need ipd entry in /etc/name_to_major</font><br/>
<font color="#000000">OS-1023 dsadm improvements &amp; manpage</font></p>

<p><font color="#000000">illumos-joyent</font><br/>
<font color="#000000">&#45;-----------------&#45;</font></p>

<p><font color="#000000">OS-978 hyperlofs</font></p>

<p><font color="#000000">OS-969 want to perturb vnics</font><br/>
<font color="#000000">OS-997 net_&#42; and hook_&#42; man pages are wrong</font><br/>
<font color="#000000">OS-1024 sysconfig(_CONFIG_AVPHYS&#95;</font><font color="#000000">PAGES) extremely slow inside zones</font><br/>
<font color="#000000">OS-986 remove more unneeded privs.</font><br/>
<font color="#000000">OS-1044 minimize prstat vm_getusage impact</font><br/>
<font color="#000000">OS-803 make phys mem cap a bit harder</font><br/>
<font color="#000000">OS-1043 minimize vm_getusage impact</font><br/>
<font color="#000000">OS-1042 increase DCE cache tunables</font><br/>
<font color="#000000">OS-1026 procfs and large file support won't co-exist</font><br/>
<font color="#000000">OS-1047 kstat for 10 sec FS ops</font><br/>
<font color="#000000">OS-1041 node process stuck in squeue mess</font><br/>
<font color="#000000">OS-1019 zone stuck in down state: amon socket in /var/run preventing shutdown</font><br/>
<font color="#000000">OS-1037 hyprlofs shouldn't require linkdir priv</font><br/>
<font color="#000000">OS-905 missing man page for hstrerror</font><br/>
<font color="#000000">OS-1032 Need symlinks for more libs under /usr/lib</font><br/>
<font color="#000000">OS-1034 hyprlofs header should not use const</font><br/>
<font color="#000000">OS-1031 zfs destroy &#45;F doesn't handle EBUSY from zfs_unmount()</font><br/>
<font color="#000000">OS-1030 hyprlofs unmount panic with dir looped in</font><br/>
<font color="#000000">OS-987 vmu_calculate_proc() impeding page faults for thousands of seconds</font><br/>
<font color="#000000">OS-1029 need hyprlofs GET ioctl</font></p>


<p><font color="#000000">In addition, this release includes a long overdue illumos-gate sync with the following fixes:</font></p>

<p><font color="#000000">998 obsolete DMA driver interfaces should be removed</font><br/>
<font color="#000000">2242 libraries should be more careful casting pointers</font><br/>
<font color="#000000">2251 kernel inlines should support gcc 4</font><br/>
<font color="#000000">2131 beadm list &#45;a missing units designation</font><br/>
<font color="#000000">2195 lm75 ignores the half degree bit in writes</font><br/>
<font color="#000000">998 obsolete DMA driver interfaces should be removed</font><br/>
<font color="#000000">2179 gss should be more careful with pointer casts</font><br/>
<font color="#000000">2163 sparc bits should be more careful casting pointers</font><br/>
<font color="#000000">2083 stmf: worker manager doesn't scale workers anymore</font><br/>
<font color="#000000">2208 Seems our find doesn't support the '-links' option, (as mandated by POSIX)</font><br/>
<font color="#000000">2075 man outputs "geqn should have been given a `-Tutf8' option"</font><br/>
<font color="#000000">2191 Clean up one EINVAL case in setsockopt(3socket)</font><br/>
<font color="#000000">2077 lots of unreachable breaks in illumos gate</font><br/>
<font color="#000000">2099 powertop output hangs under heavy load</font><br/>
<font color="#000000">934 FreeBSD's GPT not recognized</font><br/>
<font color="#000000">2088 zdb could use a reasonable manual page</font><br/>
<font color="#000000">1960 developer tools should support git</font><br/>
<font color="#000000">1941 timer intervals incorrectly rounded to clock resolution</font><br/>
<font color="#000000">1759 sun4u floating-point scrubber should be removed</font><br/>
<font color="#000000">2130 zvol DKIOCFREE uses nested DMU transactions</font><br/>
<font color="#000000">1439 Panic when booting on IBM SystemX</font><br/>
<font color="#000000">2059 nightly(1) should support custom From: in mail</font><br/>
<font color="#000000">1521 obsolete perl-584 dependency declarations break onu</font><br/>
<font color="#000000">2054 e1000g kstat structure contains needless fields</font><br/>
<font color="#000000">1588 nfs4 mirror mount hang</font><br/>
<font color="#000000">1936 add support for "-t &lt;datatype&gt;" argument to zfs get</font><br/>
<font color="#000000">1494 rtls never sets rtlsp-&gt;ifname</font><br/>
<font color="#000000">763 FMD msg URLs should refer to something visible</font><br/>
<font color="#000000">1570 add support for GB18030</font><br/>
<font color="#000000">2061 uts homebrew offsetofs cause various pointer-cast warnings</font><br/>
<font color="#000000">1694 Add type-aware print() action (fix lint)</font><br/>
<font color="#000000">1688 show zfs ioctl args in truss</font><br/>
<font color="#000000">2038 Add in I350 and ET2 support into igb</font><br/>
<font color="#000000">852 Update data files for localedef UTF-8 locales from CLDR v2.0.1 (fix unref)</font><br/>
<font color="#000000">1557 assertion failed in userland taskq_destroy()</font><br/>
<font color="#000000">2050 todpc_rtcget() returns error sometimes</font><br/>
<font color="#000000">2041 panic in nsmb_close</font><br/>
<font color="#000000">2067 uninitialized variables in zfs(1M) may make snapshots undestroyable</font><br/>
<font color="#000000">2062 libbc uname() deals with nodename/nodeext distastefully</font><br/>
<font color="#000000">2039 several declarations in uts declare functions with variable number of args even if they are not</font><br/>
<font color="#000000">852 Update data files for localedef UTF-8 locales from CLDR v2.0.1</font><br/>
<font color="#000000">1569 localedef mishandles some multibyte locales</font><br/>
<font color="#000000">2045 eject fails for active console user</font><br/>
<font color="#000000">2063 check_rtime should ignore mps</font><br/>
<font color="#000000">1594 strxfrm may write past the specified buffer</font><br/>
<font color="#000000">2055 libssh lint library includes other libraries, screws up</font><br/>
<font color="#000000">1914 libses cannot set more than one properties at once</font><br/>
<font color="#000000">1984 libses uses threshold diag page wrong way</font><br/>
<font color="#000000">1332 ssh should use YESEXPR/NOEXPR</font><br/>
<font color="#000000">2018 makedbm overwrites and overflows constant string</font><br/>
<font color="#000000">2023 libnisdb is inconsistently const-y</font><br/>
<font color="#000000">2004 newer gcc, and sanity, would benefit from a newer libdwarf</font><br/>
<font color="#000000">393 Invalid nd_hostservlist contents crash mountd</font><br/>
<font color="#000000">968 fct driver sets incorrect fc-ct revision</font><br/>
<font color="#000000">2003 md_trans_ioctl() has incorrect declaration</font><br/>
<font color="#000000">1779 panic: assertion failed: rc == DDI_SUCCESS, file: ../../common/os/devcfg.c, line: 4185</font><br/>
<font color="#000000">1890 Updated emlxs driver from Emulex</font><br/>
<font color="#000000">1668 ldap format string issues when merging search descriptors</font><br/>
<font color="#000000">1951 leaking a vdev when removing an l2cache device</font><br/>
<font color="#000000">1952 memory leak when adding a file-based l2arc device</font><br/>
<font color="#000000">1954 leak in ZFS from metaslab_group_create and zfs_ereport_checksum</font><br/>
<font color="#000000">1949 crash during reguid causes stale config</font><br/>
<font color="#000000">1953 allow and unallow missing from zpool history since removal of pyzfs</font><br/>
<font color="#000000">1955 sderr kstat should expand when a LUN is expanded</font><br/>
<font color="#000000">1909 disk sync write perf regression when slog is used post oi_148</font><br/>
<font color="#000000">1950 ztest backwards compatibility testing option</font><br/>
<font color="#000000">1982 Make rpcbind_getaddr() work with all versions of rpcbind protocol</font><br/>
<font color="#000000">1992 sharemgr show &#45;P [nfs&#124;smb] doesn't work for shared datasets</font><br/>
<font color="#000000">1993 typo bug in stmfadm.c:createHostGroupFunc(</font><font color="#000000">)</font><br/>
<font color="#000000">1848 sshd always tries to resolve client's IP to hostname</font><br/>
<font color="#000000">1978 iPsGetSetStmfProp is missing some brackets</font><br/>
<font color="#000000">1946 incorrect formatting when listing output of multiple pools with zpool iostat &#45;v</font><br/>
<font color="#000000">1988 sa_to_str can pass junk to mdb_nhconvert</font><br/>
<font color="#000000">1977 zfs allow arguments not parsed correctly after pyzfs removal</font><br/>
<font color="#000000">1971 i86 kernel should be more careful when casting pointers</font></p>


<h2><a name="SmartOSChangeLog-March8%2C2012"></a>March 8, 2012</h2>

<p><font color="#000000">Changes in this version include vmxnet drivers, mdb ::printf &amp; bug fixes:</font></p>

<p><font color="#000000">illumos-joyent</font><br/>
<font color="#000000">&#45;------------&#45;</font><br/>
<font color="#000000">OS-986 remove many default privs from KVM VMs that are unneeded.</font><br/>
<font color="#000000">OS-993 when creating zone, zfs snapshot &amp;&amp; zfs clone leave empty dataset</font><br/>
<font color="#000000">STOR-84 reserve checksum entry for ZIO_CHECKSUM_SHA256_MAC</font></p>

<p><font color="#000000">OS-954 add vmxnet driver to illumos</font><br/>
<font color="#000000">OS-1011 mdb needs ::printf</font></p>

<p><font color="#000000">smartos-live</font><br/>
<font color="#000000">&#45;----------&#45;</font></p>

<p><font color="#000000">OS-986 remove many default privs from KVM VMs that are unneeded.</font><br/>
<font color="#000000">OS-1018 fix issues when max_physical_memory is passed to override default, but the value is too low.</font><br/>
<font color="#000000">OS-1015 vmxnet needs an entry in driver_aliases</font><br/>
<font color="#000000">OS-954 add vmxnet driver to illumos</font><br/>
<font color="#000000">OS-1012: /usr/bin/json uses wrong #&#33;</font><br/>
<font color="#000000">OS-1005 build tests and include in output directory for CI to match platform with tests.</font><br/>
<font color="#000000">OS-1001 don't leave ip and nic_tag undefined when adding NIC without them.</font><br/>
<font color="#000000">OS-1000 Fix issues around updating / setting primary flag on NICs and add tests and documentation.</font><br/>
<font color="#000000">OS-999 Fix setting memory parameters to make setting bad values more difficult, add tests and better logging for such changes.</font><br/>
<font color="#000000">OS-996 fix vmadm man page for qemu_opts after VNC/vga changes</font><br/>
<font color="#000000">OS-983 don't allow 'tags' or 'nics' as &#45;o parameters to vmadm list.</font><br/>
<font color="#000000">QA-99 bump to latest version of node-tap and new dependencies.</font><br/>
<font color="#000000">OS-980 fix error handling around zones that disappear between lookup and load.</font></p>

<h2><a name="SmartOSChangeLog-Feb23%2C2012"></a>Feb 23, 2012</h2>

<p><font color="#000000">The list of changes in this release are:</font></p>

<p><font color="#000000">From illumos-joyent:</font></p>

<p><font color="#000000">OS-970 kpreemptpri should be lowered to maxclsyspri</font><br/>
<font color="#000000">OS-975 stack overflow from squeue_drain()</font><br/>
<font color="#000000">OS-948 add libdiskmgt spec as block comment</font><br/>
<font color="#000000">OS-950 zonecfg should not barf when MAC address is formatted with or without leading zeros</font><br/>
<font color="#000000">OS-928 cyclic processing fails when cy_pend is greater than INT32_MAX</font><br/>
<font color="#000000">OS-887 cyclic_remove_here() blocked with cyp_rpend of UINT32_MAX</font><br/>
<font color="#000000">OS-962 need to update copyright banner to 2012</font><br/>
<font color="#000000">manifest: Drop extra pages accidentally pruned from 317f788</font><br/>
<font color="#000000">manifest: Don't deliver manual pages actually from smartos-live</font><br/>
<font color="#000000">OS-946 IP DCE does not scale</font></p>

<p><font color="#000000">From smartos-live:</font></p>

<p><font color="#000000">OS-986 modify KVM zone startup to not need fork and to dump zone privileges to the log.</font><br/>
<font color="#000000">OS-981 added info logging for all modification actions, fixed problems with debug logging.</font><br/>
<font color="#000000">OS-984 fix error message when running 'vmadm info' on non-KVM zones.</font><br/>
<font color="#000000">OS-977 Add support for disabling VNC, setting VNC port, allowing VNC password, and changing VGA type. (Thanks Lee Essen&#33;)</font><br/>
<font color="#000000">OS-972 add documentation for nic_tag option and fix wording around quota.</font><br/>
<font color="#000000">OS-952 add jsstyle, jsl, 'make check' target and update VM.js/qmp.js and vmadm(d).js to pass checks.</font><br/>
<font color="#000000">HEAD-952 fix problems where octets were coming out all zeros.</font><br/>
<font color="#000000">OS-965 gcc44 should be pulled down automatically</font><br/>
<font color="#000000">OS-959 fix VM.js handling of 00 MAC octets</font><br/>
<font color="#000000">OS-960 /etc/system setting to disable c-states</font><br/>
<font color="#000000">AGENT-437 fix metadata startup to not depend on disks since we can't count on sdc-init (see AGENT-436)</font><br/>
<font color="#000000">AGENT-436: Metadata daemon should not depend on system/smartdc/init</font><br/>
<font color="#000000">OS-913: Fix typo in Makefile node-zsock target</font><br/>
<font color="#000000">OS-913: Add metadata agent to illumos-live</font><br/>
<font color="#000000">STOR-73 tool which reports disk vendor and product</font><br/>
<font color="#000000">QA-96 add test dir to platform to make it easier to just drop in tests.</font></p>

<p><font color="#000000">kvm &amp; kvm-cmd are unchanged</font></p>

<h2><a name="SmartOSChangeLog-February10%2C2012"></a>February 10, 2012</h2>

<p><font color="#000000">Mostly bug fixes, though we've included the COMSTAR iSCSI target bits, better errors for env, proc fixes for large memory systems, fs_allowed setable through vmadm and wall(1) &#45;z and &#45;Z to send all user messages to zones on behalf of the global.</font></p>

<h2><a name="SmartOSChangeLog-Earlier"></a>Earlier</h2>

<p>Changes since 20120113:</p>
<ul>
	<li>node 0.6</li>
</ul>


<p>Changes since 20111219:</p>
<ul>
	<li><a href="http://dtrace.org/blogs/dap/2012/01/13/playing-with-nodev8-postmortem-debugging/">v8/node.js mdb providers</a></li>
	<li>ability to hand vmadm ethernet device names rather than tags</li>
	<li>etherstub persistence via the config file</li>
</ul>


<p>Changes since 20111215:</p>
<ul>
	<li>fixed an unfortunate bug in vmadm</li>
	<li>NICs can now be specified by device name rather than tag</li>
</ul>


<p>Major changes since 20110926:</p>
<ul>
	<li>create-machine replaced with&nbsp;<a href="Using vmadm to manage virtual machines.html" title="Using vmadm to manage virtual machines"><b>vmadm</b></a></li>
</ul>


<p>Major changes since 20110813:</p>
<ul>
	<li>Persistent setup on boot: creates a zpool and datasets for /var, &nbsp; /etc/zones, /etc/ssh, /zones</li>
	<li><del>/usr/sbin/create-machine : allows you to define &amp; install a vm or zone via a json file, greatly simplifying use of the joyent brand</del>&nbsp;(replaced with vmadm create)</li>
	<li>vmadm : simplified vm management utility allowing better control &amp; &nbsp; interrogation of vms (documentation coming, but invoked without options will give usage)</li>
	<li>networking persistence : define it once ( via the dataset setup ), next reboot it's there</li>
	<li>ssh host key persistence : no more errors from ssh</li>
	<li>zone persistence</li>
	<li>root's password can now be changed from the default of 'root'</li>
</ul>


<p>Notes:</p>
<ul>
	<li>Users created on the global zone do NOT persist across reboots. Create zones for your nonroot users and applications</li>
	<li>If root's password changes, you must copy /etc/shadow to /usbkey/shadow and chmod it 0400. This is not done automatically</li>
	<li>If you wish to have the previous SmartOS behavior and bypass the dataset setup, there is a GRUB option to do so (second option on boot). Otherwise setup will run and cannot be exited.</li>
	<li>post-install changes to network configuration are done via /usbkey/config</li>
	<li>Using partitions for your data is not currently easily supported, you must use whole disks</li>
</ul>


				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="https://wiki.smartos.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jul 07, 2019 00:15</font></td>
		    </tr>
	    </table>
    </body>
</html>
